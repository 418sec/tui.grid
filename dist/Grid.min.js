!function(){"undefined"!=typeof window.console&&window.console&&window.console.log||(window.console={log:function(){},error:function(){}});var a={Layout:{},Data:{},Cell:{},Plugin:{}},b={},c={},d={};b.Base=Backbone.Model.extend({initialize:function(a){var b=a&&a.grid||this.collection&&this.collection.grid||null;this.setOwnProperties({grid:b})},setOwnProperties:function(a){_.each(a,function(a,b){this[b]=a},this)}}),d.Base=Backbone.Collection.extend({initialize:function(a){var b=a&&a.grid||this.collection&&this.collection.grid||null;this.setOwnProperties({grid:b})},setOwnProperties:function(a){_.each(a,function(a,b){this[b]=a},this)}}),a.Base=Backbone.View.extend({initialize:function(a){var b=a&&a.grid||this.collection&&this.collection.grid||null;this.setOwnProperties({grid:b,__viewList:[]})},error:function(a){var b=function(){this.name="PugException",this.message=a||"error",this.caller=arguments.caller};return b.prototype=new Error,new b},setOwnProperties:function(a){_.each(a,function(a,b){this[b]=a},this)},createView:function(a,b){var c=new a(b);return this.hasOwnProperty("__viewList")||this.setOwnProperties({__viewList:[]}),this.__viewList.push(c),c},destroy:function(){this.destroyChildren(),this.remove()},destroyChildren:function(){if(this.__viewList instanceof Array)for(;0!==this.__viewList.length;)this.__viewList.pop().destroy()}}),a.Base.PluginInterface=a.Base.extend({$super:a.Base.PluginInterface,initialize:function(){a.Base.prototype.initialize.apply(this,arguments),this.$super.__plugin=this},activate:function(){},render:function(){return this},appendTo:function(){}});var e={getTBodyHeight:function(a,b){return 0===a?a:a*(b+1)+1},getDisplayRowCount:function(a,b){return Math.ceil((a-1)/(b+1))},getRowHeight:function(a,b){return Math.floor((b-1)/a)},getUniqueKey:function(){var a=String(parseInt(1e10*Math.random(),10));return(new Date).getTime()+a},decodeHTMLEntity:function(a){var b={"&quot;":'"',"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&nbsp;":" "};return a.replace(/&amp;|&lt;|&gt;|&quot;|&#39;|&nbsp;/g,function(a){return b[a]?b[a]:a})},encodeHTMLEntity:function(a){var b={'"':"quot","&":"amp","<":"lt",">":"gt","'":"#39"};return a.replace(/[<>&"']/g,function(a){return b[a]?"&"+b[a]+";":a})}};c.ColumnModel=b.Base.extend({defaults:{keyColumnName:null,columnFixIndex:0,columnModelList:[],visibleList:[],columnModelMap:{}},initialize:function(){b.Base.prototype.initialize.apply(this,arguments),this.on("change",this._onChange,this)},_appendDefaultColumn:function(a){var b=$.extend(!0,[],a),c=[],d=this.grid.option("selectType"),e=!1,f=!1,g={_number:{columnName:"_number",title:"No.",width:60},_button:{columnName:"_button",editOption:{type:d,list:[{value:"selected"}]},width:50}};return"checkbox"===d?g._button.title='<input type="checkbox"/>':"radio"===d?g._button.title="선택":g._button.isHidden=!0,_.each(b,function(a,c){var d=a.columnName;"_number"===d?(b[c]=$.extend(a,g._number),e=!0):"_button"===d&&(b[c]=$.extend(a,g._button),f=!0)},this),e||c.push(g._number),f||c.push(g._button),b=_.union(c,b)},getColumnModelList:function(a){a=a?a.toUpperCase():void 0;var b=[],c=this.get("columnFixIndex");switch(a){case"L":b=this.get("visibleList").slice(0,c);break;case"R":b=this.get("visibleList").slice(c);break;default:b=this.get("visibleList")}return b},getColumnModel:function(a){return this.get("columnModelMap")[a]},_getVisibleList:function(){return _.filter(this.get("columnModelList"),function(a){return!a.isHidden})},_onChange:function(a){a.changed.columnModelList&&this.set({columnModelList:this._appendDefaultColumn(a.changed.columnModelList)},{silent:!0});var b=this._getVisibleList();this.set({visibleList:b,lsideList:b.slice(0,this.get("columnFixIndex")),rsideList:b.slice(this.get("columnFixIndex")),columnModelMap:_.indexBy(this.get("columnModelList"),"columnName")},{silent:!0})}}),c.Row=b.Base.extend({idAttribute:"rowKey",defaults:{_extraData:{rowState:null,selected:!1,focused:""}},initialize:function(){b.Base.prototype.initialize.apply(this,arguments),this.on("change",this.onChange,this)},onChange:function(){},getRowSpanData:function(a){var b=this.get("_extraData"),c={count:0,isMainRow:!0,mainRowKey:this.get("rowKey")};return b&&b.rowSpanData&&b.rowSpanData[a]||c}}),c.RowList=d.Base.extend({model:c.Row,initialize:function(a){d.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({_sortKey:"rowKey",_focused:{rowKey:null,columnName:""},_originalRowList:[],_startIndex:a.startIndex||1,_privateProperties:["_button","_number","_extraData"]}),this.on("change",this._onChange,this),this.on("change:_button",this._onCheckChange,this),this.on("sort",this._onSort,this),this.on("all",this.test1,this)},test1:function(){},_onSort:function(){console.log("sort"),this._refreshNumber()},_refreshNumber:function(){for(var a=0;a<this.length;a++)this.at(a).set("_number",this._startIndex+a,{silent:!0})},_isPrivateProperty:function(a){return-1!==$.inArray(a,this._privateProperties)},_onChange:function(a){var b=function(a,b){return{rowKey:a.get("rowKey"),columnName:b,columnData:a.get(b)}};_.each(a.changed,function(c,d){if(!this._isPrivateProperty(d)){var e=this.grid.columnModel.getColumnModel(d);if(!e)return;var f,g=a.getRowSpanData(d),h=b(a,d);if(e.editOption&&e.editOption.changeBeforeCallback&&e.editOption.changeBeforeCallback(h)===!1)return f={},f[d]=a.previous(d),a.set(f),void a.trigger("restore",{changed:f});if(!this.isSortedByField())if(g.isMainRow)for(var i=this.indexOf(this.get(a.get("rowKey"))),j=0;j<g.count-1;j++)this.at(j+1+i).set(d,c);else this.get(g.mainRowKey).set(d,c);h=b(a,d),e.editOption&&e.editOption.changeAfterCallback&&e.editOption.changeAfterCallback(h),a.set("_button",!0)}},this)},_onCheckChange:function(a){var b,c=(this.grid.columnModel.getColumnModel("_button"),this.grid.option("selectType")),d=a.get("rowKey");"radio"===c&&(b=this.where({_button:!0}),_.each(b,function(a){d!=a.get("rowKey")&&a.set({_button:!1},{silent:!0})}))},isSortedByField:function(){return"rowKey"!==this._sortKey},sortByField:function(a){this._sortKey=a,this.sort()},comparator:function(a){return this.isSortedByField()?1*a.get(this._sortKey):void 0},setValue:function(a,b,c,d){var e=this.get(a),f={};return e?(f[b]=c,e.set(f,{silent:d}),!0):!1},setColumnValue:function(a,b,c){var d={};d[a]=b,this.forEach(function(a){a.set(d,{silent:c})},this)},setExtraData:function(a,b,c){var d,e=this.get(a),f={};return e?(d=_.clone(e.get("_extraData")),d=$.extend(d,b),f._extraData=d,e.set(f,{silent:c}),!0):!1},selectRow:function(a,b){return this.unselectRow().setExtraData(a,{selected:!0},b)&&(this._focused.rowKey=a),this},unselectRow:function(a){return this.setExtraData(this._focused.rowKey,{selected:!1},a)&&(this._focused.rowKey=null),this},focusCell:function(a,b){return a=void 0===a?this._focused.rowKey:a,b=void 0===b?this._focused.columnName:b,this.blurCell().selectRow(a),b&&(this._focused.columnName=b,this.setExtraData(a,{focused:b})),this},blurCell:function(){var a=this._focused.rowKey;return void 0!==a&&null!==a&&(this._focused.columnName="",this.setExtraData(a,{focused:""})),this},getFocused:function(){return _.clone(this._focused)},parse:function(a){return this._originalRowList=this._parse(a),this._originalRowList},_filterRowList:function(a){for(var b,c=[],d=0,e=a.length;e>d;d++)b={},_.each(a[d],function(a,c){this._isPrivateProperty(c)||(b[c]=a)},this),c.push(b);return c},getModifiedRowList:function(){var a=_.indexBy(this._filterRowList(this._originalRowList),"rowKey"),b=_.indexBy(this._filterRowList(this.toJSON()),"rowKey"),c={inserted:[],edited:[],deleted:[]};return _.each(b,function(b,d){a[d]?JSON.stringify(b)!==JSON.stringify(a[d])&&c.edited.push(b):c.inserted.push(b)},this),_.each(a,function(a,d){b[d]||c.deleted.push(a)},this),c},_parse:function(a){function b(a,b,c){a.rowSpanData=a&&a.rowSpanData||{},a.rowSpanData[b]=c}function c(a,b){return!(!a.rowSpanData||!a.rowSpanData[b])}for(var d,e,f=a,g=this.grid.columnModel.get("keyColumnName"),h=0;h<f.length;h++)if(e=null===g?h:f[h][g],f[h].rowKey=e,f[h]._button=!1,this.isSortedByField())f[h]._extraData&&(f[h]._extraData.rowSpan=null);else if(f[h]._extraData&&f[h]._extraData.rowSpan)for(var i in f[h]._extraData.rowSpan)if(!c(f[h]._extraData,i)){d=f[h]._extraData.rowSpan[i],b(f[h]._extraData,i,{count:d,isMainRow:!0,mainRowKey:f[h].rowKey});for(var j=-1,k=h+1;h+d>k;k++)f[k][i]=f[h][i],f[k]._extraData=f[k]._extraData||{},b(f[k]._extraData,i,{count:j--,isMainRow:!1,mainRowKey:f[h].rowKey})}return f},_getEmptyRow:function(){for(var a=this.grid.columnModel.get("columnModelList"),b={},c=0;c<a.length;c++)b[a[c].columnName]="";return b},append:function(a,b){b=void 0!==b?b:this.length;var d,e=[],f=this.grid.columnModel.get("key"),g=this.length,a=a||this._getEmptyRow();a instanceof Array||(a=[a]),d=this._parse(a),_.each(d,function(a,b){a.rowKey=f?a[f]:g+b,e.push(new c.Row(a))},this),this.add(e,{at:b,merge:!0}),this._refreshNumber()},prepend:function(a){this.append(a,0)}}),b.Cell=b.Base.extend({defaults:{rowKey:"",columnName:"",value:"",rowSpan:0,isMainRow:!0,mainRowKey:"",isEditable:!1,optionList:[],isDisabled:!1,className:"",selected:!1,focused:!1},initialize:function(a){b.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({_model:a._model||null,attrProperties:["isDisabled","className","selected","focused"]});var c=a.columnName;this.listenTo(this._model,"change:"+c,this._onModelChange,this),this.on("change",this._onChange,this)},_onModelChange:function(a,b){var c=this.grid.columnModel.getColumnModel(this.get("columnName"));c.affectOption,this.set("value",b)},_onChange:function(a){var b=!1;_.each(a.changed,function(a,c){-1===$.inArray(c,this.attrProperties)&&(b=!0)},this),b===!0?this.trigger("render",a):this.trigger("changeAttr",a)},setValue:function(a){this._model.set(this.get("columnName"),a)}}),b.Dimension=b.Base.extend({models:null,columnModel:null,defaults:{width:0,headerHeight:0,bodyHeight:0,rowHeight:0,rsideWidth:0,lsideWidth:0,columnWidthList:[]},initialize:function(){b.Base.prototype.initialize.apply(this,arguments),this.columnModel=this.grid.columnModel,this.listenTo(this.columnModel,"change",this._onWidthChange),this.on("change:width",this._onWidthChange,this),this._setColumnWidth(),this._setBodyHeight(),this._setHeaderHeight(),this.setOwnProperties({timeoutIdForResize:0}),$(window).on("resize",$.proxy(this._onWindowResize,this))},_onWindowResize:function(){clearTimeout(this.timeoutIdForResize),this.timeoutIdForResize=setTimeout($.proxy(function(){var a=Math.max(this.grid.option("minimumWidth"),this.grid.$el.css("width","100%").width());this.set("width",a)},this),100)},_onWidthChange:function(){var a=this.get("columnWidthList");this._setColumnWidth(this._calculateColumnWidthList(a))},_setBodyHeight:function(){var a=e.getTBodyHeight(this.grid.option("displayRowCount"),this.get("rowHeight"));a+=this.grid.scrollBarSize,this.set("bodyHeight",a)},getDisplayRowCount:function(){return e.getDisplayRowCount(this.get("bodyHeight"),this.get("rowHeight"))},_setHeaderHeight:function(){var a=this.grid.option("headerHeight");this.set("headerHeight",a)},_setColumnWidth:function(a){for(var b,c=0,a=a||this._getOriginalWidthList(),d=this.get("width"),e=this.columnModel.get("columnFixIndex"),f=0,g=a.length;g>f;f++)e>f&&(c+=a[f]+1);c+=1,b=d-c,this.set({rsideWidth:b,lsideWidth:c,columnWidthList:a}),this.trigger("columnWidthChanged")},setColumnWidth:function(a,b){b=Math.max(b,this.grid.option("minimumColumnWidth"));var c=this.get("columnWidthList");c[a]=b;var d=this._calculateColumnWidthList(c);this._setColumnWidth(d)},getColumnWidthList:function(a){a=a?a.toUpperCase():void 0;var b=this.columnModel.get("columnFixIndex"),c=[];switch(a){case"L":c=this.get("columnWidthList").slice(0,b);break;case"R":c=this.get("columnWidthList").slice(b);break;default:c=this.get("columnWidthList")}return c},_getOriginalWidthList:function(){for(var a=this.columnModel.get("visibleList"),b=[],c=0,d=a.length;d>c;c++)b.push(a[c].width?a[c].width:-1);return this._calculateColumnWidthList(b)},_calculateColumnWidthList:function(a){for(var b,c,d=[],e=this.get("width"),f=0,g=0,h=0,i=0,j=a.length;j>i;i++)a[i]>0?(f=Math.max(this.grid.option("minimumColumnWidth"),a[i]),d.push(f),g+=f):(d.push(-1),h++);b=e-g,e>g&&0===h&&(d[d.length-1]+=b),e>g?(b=e-g,c=Math.max(this.grid.option("minimumColumnWidth"),Math.floor(b/h))):c=this.grid.option("minimumColumnWidth");for(var i=0,j=d.length;j>i;i++)-1===d[i]&&(d[i]=c);return d}}),b.Renderer=b.Base.extend({defaults:{top:0,scrollTop:0,scrollLeft:0,startIdx:0,endIdx:0,lside:null,rside:null},initialize:function(){b.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({timeoutIdForRefresh:0,isColumnModelChanged:!1}),this.listenTo(this.grid.columnModel,"all",this._onColumnModelChange,this),this.listenTo(this.grid.dataModel,"add remove sort reset",this._onRowListChange,this);var a=new b.RowList({grid:this.grid}),c=new b.RowList({grid:this.grid});this.set({lside:a,rside:c})},getCollection:function(a){a=a?a.toUpperCase():void 0;var b;switch(a){case"L":b=this.get("lside");break;case"R":b=this.get("rside");break;default:b=this.get("rside")}return b},_onColumnModelChange:function(){this.set({scrollTop:0,top:0,startIdx:0,endIdx:0}),this.isColumnModelChanged=!0,clearTimeout(this.timeoutIdForRefresh),this.timeoutIdForRefresh=setTimeout($.proxy(this.refresh,this),0)},_onRowListChange:function(){clearTimeout(this.timeoutIdForRefresh),this.timeoutIdForRefresh=setTimeout($.proxy(this.refresh,this),0)},_setRenderingRange:function(){this.set({startIdx:0,endIdx:this.grid.dataModel.length-1})},refresh:function(){this.trigger("beforeRefresh"),this._setRenderingRange();var a=this.grid.columnModel.get("columnFixIndex"),b=this.grid.columnModel.get("visibleList"),c=_.pluck(b,"columnName"),d=c.slice(0,a),e=c.slice(a),f=[],g=[],h=[],i=[],j=this.get("startIdx"),k=this.get("endIdx"),l=new Date;console.log("render",j,k);for(var m=j;k+1>m;m++){var n=this.grid.dataModel.at(m),o=n.get("rowKey");h={_extraData:n.get("_extraData"),rowKey:o},i={_extraData:n.get("_extraData"),rowKey:o},_.each(d,function(a){h[a]=n.get(a)},this),_.each(e,function(a){i[a]=n.get(a)},this),f.push(h),g.push(i)}this.get("lside").set(f,{parse:!0}),this.get("rside").set(g,{parse:!0});var p=new Date;console.log("render done",p-l),this.isColumnModelChanged===!0?(this.trigger("columnModelChanged"),this.isColumnModelChanged=!1):this.trigger("rowListChanged"),this.trigger("afterRefresh")}}),b.Renderer.Smart=b.Renderer.extend({initialize:function(){b.Renderer.prototype.initialize.apply(this,arguments),this.on("change:scrollTop",this._onScrollTopChange,this),this.setOwnProperties({hiddenRowCount:10,criticalPoint:3})},_onScrollTopChange:function(){this._shouldRender()===!0&&this.refresh()},_setRenderingRange:function(){var a,b=this.get("scrollTop"),c=this.grid.dimensionModel.get("rowHeight"),d=(this.grid.dimensionModel.get("bodyHeight"),this.grid.dimensionModel.getDisplayRowCount()),f=Math.max(0,Math.ceil(b/(c+1))-this.hiddenRowCount),g=Math.min(this.grid.dataModel.length-1,Math.floor(f+this.hiddenRowCount+d+this.hiddenRowCount));if(!this.grid.dataModel.isSortedByField()){var h=[],i=[];_.each(this.grid.dataModel.at(f).get("_extraData").rowSpanData,function(a){a.isMainRow||h.push(a.count)},this),_.each(this.grid.dataModel.at(g).get("_extraData").rowSpanData,function(a){a.count>0&&i.push(a.count)},this),h.length>0&&(f+=Math.min.apply(Math,h)),i.length>0&&(g+=Math.max.apply(Math,i))}a=0===f?0:e.getTBodyHeight(f,c)+1,this.set({top:a,startIdx:f,endIdx:g})},_shouldRender:function(){var a=this.get("scrollTop"),b=this.grid.dimensionModel.get("rowHeight"),c=this.grid.dimensionModel.get("bodyHeight"),d=(this.grid.dimensionModel.getDisplayRowCount(),this.grid.dataModel.length),e=Math.max(0,Math.ceil(a/(b+1))),f=Math.min(this.grid.dataModel.length-1,Math.floor((a+c)/(b+1))),g=this.get("startIdx"),h=this.get("endIdx");return 0!==g&&g+this.criticalPoint>e||h!==d-1&&d>h&&h-this.criticalPoint<f?(console.log(g+this.criticalPoint,e),console.log(h-this.criticalPoint,f),!0):!1}}),b.Row=b.Base.extend({idAttribute:"rowKey",defaults:{},initialize:function(a){b.Base.prototype.initialize.apply(this,arguments);var c=a&&a.rowKey;this.grid.dataModel.get(c)&&(this.listenTo(this.grid.dataModel.get(c),"change",this._onModelChange,this),this.listenTo(this.grid.dataModel.get(c),"restore",this._onModelChange,this))},_onModelChange:function(a){_.each(a.changed,function(a,b){"_extraData"===b?this.correctRowSpanData(a):this.setCell(b,{value:a})},this)},_onExtraDataChange:function(a){var b=a.get("_extraData");this.correctRowSpanData(b)},correctRowSpanData:function(a){if(this.collection){var b=a.selected||!1,c=a.focused,d=this.grid.columnModel.get("visibleList");_.each(d,function(a){var d=a.columnName,e=this.get(d),f=this,g=d===c;e&&(this.grid.dataModel.isSortedByField()?f.setCell(d,{focused:g,selected:b}):this.collection.get(e.mainRowKey)&&(f=this.collection.get(e.mainRowKey),f.setCell(d,{focused:g,selected:b})))},this)}},parse:function(a){this.executeAffectOption(a);var b=(this.collection.grid.columnModel.get("columnModelList"),a.rowKey);return _.each(a,function(c,d){var e,f=a._extraData.focused===d,g=!!a._extraData.selected,h={mainRowKey:b,count:0,isMainRow:!0};if("rowKey"!==d&&"_extraData"!==d){e=this.collection.grid.dataModel.isSortedByField()?h:a._extraData&&a._extraData.rowSpanData&&a._extraData.rowSpanData[d]||h;{this.collection.grid.dataModel.get(b)}a[d]={rowKey:b,columnName:d,value:c,rowSpan:e.count,isMainRow:e.isMainRow,mainRowKey:e.mainRowKey,isEditable:!1,optionList:[],isDisabled:!1,className:"",focused:f,selected:g,changed:[]}}},this),a},executeAffectOption:function(){},setCell:function(a,b){if(this.get(a)){var c=_.clone(this.get(a)),d=!1,e=[];for(var f in b)d="value"===f?!0:d,c[f]=b[f],e.push(f);c.changed=e,this.set(a,c)}}}),b.RowList=d.Base.extend({model:b.Row,initialize:function(){d.Base.prototype.initialize.apply(this,arguments),this.on("sort",this.onSort,this)},onSort:function(){var a=this.grid.dataModel.getFocused();null!==a.rowKey&&this.grid.dataModel.focusCell()}}),a.Layout.Body=a.Base.extend({tagName:"div",className:"data",template:_.template('<div class="table_container" style="top: 0px">    <table width="100%" border="0" cellspacing="1" cellpadding="0" bgcolor="#EFEFEF">        <colgroup><%=colGroup%></colgroup>        <tbody></tbody>    </table></div>'),events:{scroll:"_onScroll"},initialize:function(b){a.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:b&&b.whichSide||"R"}),this.listenTo(this.grid.renderModel,"change:scrollTop",this._onScrollTopChange,this),this.listenTo(this.grid.renderModel,"beforeRefresh",this._onBeforeRefresh,this),this.listenTo(this.grid.renderModel,"change:top",this._onTopChange,this),this.listenTo(this.grid.dimensionModel,"columnWidthChanged",this._onColumnWidthChanged,this)},_onColumnWidthChanged:function(){for(var a=this.grid.dimensionModel.getColumnWidthList(this.whichSide),b=this.$el.find("col"),c=0;c<b.length;c++)b.eq(c).css("width",a[c]+"px")},_onScroll:function(a){var b={};b.scrollTop=a.target.scrollTop,"R"===this.whichSide&&(b.scrollLeft=a.target.scrollLeft),this.grid.renderModel.set(b)},_onScrollTopChange:function(a,b){this.el.scrollTop=b},_onTopChange:function(a,b){this.$el.children().css("top",b+"px")},_onBeforeRefresh:function(){this.el.scrollTop=this.grid.renderModel.get("scrollTop")},_getViewCollection:function(){return this.grid.renderModel.getCollection(this.whichSide)},render:function(){this.destroyChildren(),this.$el.css({height:this.grid.dimensionModel.get("bodyHeight")}),this.$el.html(this.template({colGroup:this._getColGroupMarkup()}));var b=this.createView(a.RowList,{grid:this.grid,collection:this._getViewCollection(),el:this.$el.find("tbody"),whichSide:this.whichSide});return b.render(),this},_getColGroupMarkup:function(){for(var a=this.grid.columnModel,b=this.grid.dimensionModel,c=b.getColumnWidthList(this.whichSide),d=a.getColumnModelList(this.whichSide),e="",f=0,g=c.length;g>f;f++)e+='<col columnname="'+d[f].columnName+'" style="width:'+c[f]+'px">';return e}}),a.CellFactory=a.Base.extend({initialize:function(){a.Base.prototype.initialize.apply(this,arguments);var b={grid:this.grid},c={mainButton:new a.Cell.MainButton(b),normal:new a.Cell.Normal(b),text:new a.Cell.Text(b),button:new a.Cell.List.Button(b),select:new a.Cell.List.Select(b)};this.setOwnProperties({instances:c})},getInstance:function(a){var b=null;switch(a){case"mainButton":b=this.instances[a];break;case"text":b=this.instances[a];break;case"select":b=this.instances[a];break;case"radio":case"checkbox":b=this.instances.button;break;default:b=this.instances.normal}return b}}),a.Clipboard=a.Base.extend({staticData:null,tagName:"textarea",className:"clipboard",events:{keydown:"_onKeydown"},initialize:function(){a.Base.prototype.initialize.apply(this,arguments)},activate:function(){this.listenTo(this.grid,"afterRender",this.appendTo,this),this.listenTo(this.grid,"mousedown",this._onGridMouseDown,this)},appendTo:function(){this.grid.$el.append(this.render().el)},render:function(){return this},_onGridMouseDown:function(){this.$el.focus()},_onKeydown:function(a){console.log("onkeydown rowList",this.grid),console.log("clipboard",a)}}),a.Layout.Footer=a.Base.extend({tagName:"div",className:"footer",render:function(){return this.$el.html("footer"),this}}),a.Layout.Frame.Lside=a.Layout.Frame.extend({className:"lside_area",initialize:function(){a.Layout.Frame.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:"L"})},_onColumnWidthChanged:function(){var a=this.grid.dimensionModel.get("lsideWidth");this.$el.css({width:a+"px"})},beforeRender:function(){var a=this.grid.dimensionModel.get("lsideWidth");this.$el.css({display:"block",width:a+"px"})}}),a.Layout.Frame.Rside=a.Layout.Frame.extend({className:"rside_area",initialize:function(){a.Layout.Frame.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:"R"})},_onColumnWidthChanged:function(){var a=this.grid.dimensionModel,b=a.get("lsideWidth"),c=a.get("rsideWidth");this.$el.css({width:c+"px",marginLeft:b+"px"})},beforeRender:function(){var a=this.grid.dimensionModel,b=a.get("lsideWidth"),c=a.get("rsideWidth");this.$el.css({display:"block",width:c+"px",marginLeft:b+"px"})},afterRender:function(){var b,c=$("<div></div>");c.css({height:this.grid.dimensionModel.get("headerHeight")-2}).addClass("space"),this.$el.append(c),this.grid.option("notUseSmartRendering")===!1&&(b=this.createView(a.Layout.Frame.Rside.VirtualScrollBar,{grid:this.grid}),this.$el.append(b.render().el),console.log(this.$el.html()))}}),a.Layout.Frame.Rside.VirtualScrollBar=a.Base.extend({tagName:"div",className:"virtual_scrollbar",initialize:function(){a.Base.prototype.initialize.apply(this,arguments),this.listenTo(this.grid.dataModel,"sort add remove reset",this._setHeight,this),this.listenTo(this.grid.dimensionModel,"change",this._onDimensionChange,this),this.listenTo(this.grid.renderModel,"change:scrollTop",this._onScrollTopChange,this)},template:_.template('<div class="content"></div>'),events:{scroll:"_onScroll"},_onScroll:function(a){this.grid.renderModel.set("scrollTop",a.target.scrollTop)},_onDimensionChange:function(a){(a.changed.headerHeight||a.changed.bodyHeight)&&this.render()},_onScrollTopChange:function(a,b){this.el.scrollTop=b},render:function(){return this.$el.css({height:this.grid.dimensionModel.get("bodyHeight")-this.grid.scrollBarSize,top:this.grid.dimensionModel.get("headerHeight"),display:"block"}).html(this.template()),this._setHeight(),this},_setHeight:function(){var a=this.grid.dimensionModel.get("rowHeight"),b=this.grid.dataModel.length,c=a*this.grid.dataModel.length+(b+1);this.$el.find(".content").height(c)}}),a.Layout.Frame=a.Base.extend({tagName:"div",className:"lside_area",initialize:function(){a.Base.prototype.initialize.apply(this,arguments),this.listenTo(this.grid.renderModel,"columnModelChanged",this.render,this),this.listenTo(this.grid.dimensionModel,"columnWidthChanged",this._onColumnWidthChanged,this),this.setOwnProperties({header:null,body:null})},render:function(){this.destroyChildren(),this.trigger("beforeRender"),this.beforeRender();var b=this.header=this.createView(a.Layout.Header,{grid:this.grid,whichSide:this.whichSide}),c=this.body=this.createView(a.Layout.Body,{grid:this.grid,whichSide:this.whichSide});return this.$el.append(b.render().el).append(c.render().el),this.afterRender(),this.trigger("afterRender"),this},beforeRender:function(){},afterRender:function(){}}),a.Layout.Header=a.Base.extend({tagName:"div",className:"header",viewList:[],whichSide:"R",events:{click:"_onClick"},initialize:function(b){a.Base.prototype.initialize.apply(this,arguments),this.whichSide=b.whichSide,this.viewList=[],this.listenTo(this.grid.renderModel,"change:scrollLeft",this._onScrollLeftChange,this),this.listenTo(this.grid.dimensionModel,"columnWidthChanged",this._onColumnWidthChanged,this)},_onColumnWidthChanged:function(){for(var a=this._getColumnData(),b=a.widthList,c=this.$el.find("col"),d=0;d<c.length;d++)c.eq(d).css("width",b[d]+"px")},_onScrollLeftChange:function(a,b){"R"===this.whichSide&&(this.el.scrollLeft=b)},_onClick:function(a){var b=$(a.target);"_button"===b.closest("th").attr("columnname")},template:_.template('    <table width="100%" border="0" cellspacing="1" cellpadding="0" bgcolor="#EFEFEF">        <colgroup><%=colGroup%></colgroup>        <tbody><%=tBody%></tbody>    </table>'),render:function(){this.destroyChildren();var b=this.createView(a.Layout.Header.ResizeHandler,{whichSide:this.whichSide,grid:this.grid});return this.$el.css({height:this.grid.dimensionModel.get("headerHeight")}).html(this.template({colGroup:this._getColGroupMarkup(),tBody:this._getTableBodyMarkup()})),this.$el.append(b.render().el),this},_getColumnData:function(){var a=this.grid.columnModel,b=this.grid.dimensionModel,c=b.getColumnWidthList(this.whichSide),d=a.getColumnModelList(this.whichSide);return{widthList:c,modelList:d}},_getColGroupMarkup:function(){for(var a=this._getColumnData(),b=a.widthList,c=a.modelList,d="",e=0,f=b.length;f>e;e++)d+='<col columnname="'+c[e].columnName+'" style="width:'+b[e]+'px">';return d},_getHeaderHeight:function(){return this.grid.dimensionModel.get("headerHeight")},_getTableBodyMarkup:function(){for(var a,b,c,d,f,g=this._getColumnHierarchyList(),h=this._getHierarchyMaxRowCount(g),i=(this._getColumnData(),this._getHeaderHeight()),j=new Array(h),k=[],l="",m="",n="",o="",p="",q=new Array(h),r=[],s=1,t=e.getRowHeight(h,i)-1,u=0;u<g.length;u++){d=g[u].length,b=0;for(var v=0;d>v;v++)s=d-1==v&&h-d+1>1?h-d+1:1,c=g[u][v],a=t*s,v===d-1?a=i-b-2:b+=a+1,q[v]==c.columnName?(j[v].pop(),r[v]+=1):r[v]=1,q[v]=c.columnName,l=" columnName='"+c.columnName+"'",n=" height='"+a+"'",p=s>1?" rowSpan='"+s+"'":"",o=r[v]>1?" colSpan='"+r[v]+"'":"",j[v]=j[v]||[],f=c.title,j[v].push("<th"+l+m+n+p+o+">"+f+"</th>")}for(var u=0;u<j.length;u++)k.push("<tr>"+j[u].join("")+"</tr>");return k.join("")},_getHierarchyMaxRowCount:function(a){var b=[];return _.each(a,function(a){b.push(a.length)},this),Math.max.apply(Math,b)},_getColumnHierarchyList:function(){var a=this._getColumnData().modelList,b=[];return _.each(a,function(a){b.push(this._getColumnHierarchy(a).reverse())},this),b},_getColumnHierarchy:function(a,b){var c=this.grid.option("columnMerge"),b=b||[];if(a&&(b.push(a),c))for(var d=0;d<c.length;d++)-1!==$.inArray(a.columnName,c[d].columnNameList)&&(b=this._getColumnHierarchy(c[d],b));return b}}),a.Layout.Header.ResizeHandler=a.Base.extend({tagName:"div",className:"resize_handle_container",viewList:[],whichSide:"R",events:{"mousedown .resize_handle":"_onMouseDown"},initialize:function(b){a.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:b.whichSide,isResizing:!1,$target:null,differenceLeft:0,initialWidth:0,initialOffsetLeft:0,initialLeft:0}),this.listenTo(this.grid.dimensionModel,"columnWidthChanged",this._refreshHandlerPosition,this)},_getColumnData:function(){var a=this.grid.columnModel,b=this.grid.dimensionModel,c=b.getColumnWidthList(this.whichSide),d=a.getColumnModelList(this.whichSide);return{widthList:c,modelList:d}},_getResizeHandler:function(){for(var a=this._getColumnData(),b=a.modelList,c=[],d=this.grid.dimensionModel.get("headerHeight"),e=0;e<b.length;e++)c.push("<div columnIndex='"+e+"' columnName='"+b[e].columnName+"' class='resize_handle"+(e+1==b.length?" resize_handle_last":"")+"' style='height:"+d+"px;' title='마우스 드래그를 통해 컬럼의 넓이를 변경할 수 있고,\n더블클릭을 통해 넓이를 초기화할 수 있습니다.'></div>");return c.join("")},render:function(){var a=this.grid.dimensionModel.get("headerHeight");return this.$el.empty(),this.$el.show().css({marginTop:-a+"px",height:a+"px"}).html(this._getResizeHandler()),this._refreshHandlerPosition(),this},_refreshHandlerPosition:function(){for(var a=this._getColumnData(),b=a.widthList,c=this.$el.find(".resize_handle"),d=0,e=0,f=c.length;f>e;e++)d+=b[e]+1,c.eq(e).css("left",d-3+"px")},_isResizing:function(){return!!this.isResizing},_onMouseDown:function(a){this._startResizing(a)},_onMouseUp:function(){this._stopResizing(),this.isResizing=!1},_onMouseMove:function(a){if(this._isResizing()){a.preventDefault();var b=a.pageX-this.initialOffsetLeft;this.$target.css("left",b+"px");var c=this._calculateWidth(a.pageX),d=parseInt(this.$target.attr("columnindex"),10);this.grid.dimensionModel.setColumnWidth(this._getColumnIndex(d),c)}},_calculateWidth:function(a){var b=a-this.initialOffsetLeft-this.initialLeft;return this.initialWidth+b},_getColumnIndex:function(a){return"R"===this.whichSide?a+this.grid.columnModel.get("columnFixIndex"):a},_startResizing:function(a){var b=this._getColumnData(),c=b.widthList,d=$(a.target);this.isResizing=!0,this.$target=d,this.initialLeft=parseInt(d.css("left").replace("px",""),10),this.initialOffsetLeft=this.$el.offset().left,this.initialWidth=c[d.attr("columnindex")],this.grid.$el.bind("mousemove",$.proxy(this._onMouseMove,this)).bind("mouseup",$.proxy(this._onMouseUp,this)).css("cursor","col-resize")},_stopResizing:function(){this.isResizing=!1,this.$target=null,this.initialLeft=0,this.initialOffsetLeft=0,this.initialWidth=0,this.grid.$el.unbind("mousemove",$.proxy(this._onMouseMove,this)).unbind("mouseup",$.proxy(this._onMouseUp,this)).css("cursor","default")}}),a.Row=a.Base.extend({tagName:"tr",events:{click:"_onClick",mousedown:"_onMouseDown"},destroy:function(){this.destroyChildren(),this._detachHandler(),this.remove()},initialize:function(b){a.Base.prototype.initialize.apply(this,arguments);var c=b&&b.whichSide||"R";this.setOwnProperties({whichSide:c,columnModelList:this.grid.columnModel.getColumnModelList(c),renderer:[],eventHandlerList:[]}),this.listenTo(this.model,"change",this._onModelChange,this)},_onClick:function(){},_onMouseDown:function(a){var b=$(a.target).closest("td");this.grid.dataModel.focusCell(this.model.get("rowKey"),b.attr("columnName")),"radio"===this.grid.option("selectType")&&this.grid.checkRow(this.model.get("rowKey"))},_onModelChange:function(a){_.each(a.changed,function(a,b){if("_extraData"!==b){var c=this.getEditType(b),d=this.grid.cellFactory.getInstance(c);d.onModelChange(a,this.$el)}},this)},_attachHandler:function(){for(var a,b,c,d=0;d<this.eventHandlerList.length;d++)a=this.eventHandlerList[d].selector,b=this.eventHandlerList[d].cellInstance,c=this.$el.find(a),b._attachHandler(c)},_detachHandler:function(){for(var a,b,c=0;c<this.eventHandlerList.length;c++)a=this.eventHandlerList[c].selector,b=this.eventHandlerList[c].cellInstance,b._detachHandler(this.$el.find(a))},getEditType:function(a){var b=this.grid.columnModel.getColumnModel(a);return"_button"===a?"mainButton":b.editOption&&b.editOption.type},render:function(){this.destroyChildren(),this._detachHandler(),this.$el.css({height:this.grid.dimensionModel.get("rowHeight")}).attr({key:this.model.get("rowKey")}),this.$el.html("");var a,b,c,d,e=this.columnModelList,f="";this.eventHandlerList=[];for(var g=0,h=e.length;h>g;g++)a=e[g].columnName,b=this.model.get(a),b&&b.isMainRow&&(c=this.getEditType(a),d=this.grid.cellFactory.getInstance(c),f+=d.getHtml(b),this.eventHandlerList.push({selector:'td[columnName="'+a+'"]',cellInstance:d}));
return this.$el.prepend(f),this._attachHandler(),this}}),a.RowList=a.Base.extend({initialize:function(b){a.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:b&&b.whichSide||"R",timeoutIdForCollection:0}),this.listenTo(this.grid.renderModel,"rowListChanged",this.render,this)},render:function(){return this.destroyChildren(),this.$el.html(""),this.addAll(),this},addOne:function(b){var c=this.createView(a.Row,{grid:this.grid,model:b,whichSide:this.whichSide});this.$el.append(c.render().el)},addAll:function(){var b=new Date;console.log("View.RowList.addAll start");var c=$(document.createDocumentFragment());this.collection.forEach(function(b){var d=this.createView(a.Row,{grid:this.grid,model:b,whichSide:this.whichSide});c.append(d.render().el)},this),this.$el.html(""),this.$el.prepend(c);var d=new Date;console.log("View.RowList.addAll end",d-b)}}),a.Cell.Base=a.Base.extend({eventHandler:{},shouldRenderList:["isEditable","optionList","value"],initialize:function(){var b={};a.Base.prototype.initialize.apply(this,arguments),_.each(this.eventHandler,function(a,c){b[c]=$.proxy(this[a],this)},this),this.setOwnProperties({_eventHandler:b})},baseTemplate:_.template('<td  columnName="<%=columnName%>" rowSpan="<%=rowSpan%>" class="<%=className%>" <%=attributes%>><%=content%></td>'),onModelChange:function(a,b){var c=this._getCellElement(a.columnName,b),d=!1;this._setFocusedClass(a,c);for(var e=0;e<this.shouldRenderList.length;e++)if(-1!==$.inArray(this.shouldRenderList[e],a.changed)){d=!0;break}d===!0?this.render(a,c):this.setElementAttribute(a,c)},_attachHandler:function(a){_.each(this._eventHandler,function(b,c){var d=c.split(" "),e=d[0],f=d[1]||"";f&&(a=a.find(f)),a.off(e).on(e,b)},this)},_detachHandler:function(a){_.each(this._eventHandler,function(b,c){var d=c.split(" "),e=d[0],f=d[1]||"";f&&(a=a.find(f)),a.off(e)},this)},_setFocusedClass:function(a,b){a.selected===!0?b.addClass("selected"):b.removeClass("selected"),a.focused===!0?b.addClass("focused"):b.removeClass("focused")},setElementAttribute:function(){},render:function(a,b){this._detachHandler(b),b.html(this.getContentHtml(a)),this._attachHandler(b)},getHtml:function(a){var b=[];return a.className&&b.push(a.className),a.selected===!0&&b.push("selected"),a.focused===!0&&b.push("focused"),this.baseTemplate({columnName:a.columnName,rowSpan:a.rowSpan,className:b.join(" "),attributes:this.getAttributes(a),content:this.getContentHtml(a)})},getAttributesString:function(a){var b="";return _.each(a,function(a,c){b+=" "+c+'="'+a+'"'},this),b},getEventHandler:function(){return this._eventHandler},getContentHtml:function(a){return a.value},getAttributes:function(){return""},_getColumnName:function(a){return a.closest("td").attr("columnName")},_getRowKey:function(a){return a.closest("tr").attr("key")},_getCellElement:function(a,b){return b.find('td[columnName="'+a+'"]')},_getCellAddr:function(a){return{rowKey:this._getRowKey(a),columnName:this._getColumnName(a)}}}),a.Cell.Interface=a.Cell.Base.extend({shouldRenderList:["isEditable","optionList","value"],eventHandler:{},initialize:function(){a.Cell.Base.prototype.initialize.apply(this,arguments)},getContentHtml:function(){throw this.error("Implement getContentHtml(cellData, $target) method. On re-rendering")},setElementAttribute:function(){throw this.error("Implement setElementAttribute(cellData, $target) method. ")}}),a.Cell.List=a.Cell.Interface.extend({shouldRenderList:["isEditable","optionList"],eventHandler:{},initialize:function(){a.Cell.Interface.prototype.initialize.apply(this,arguments)},getContentHtml:function(){throw this.error("Implement getContentHtml(cellData, $target) method. On re-rendering")},setElementAttribute:function(){throw this.error("Implement setElementAttribute(cellData, $target) method. ")}}),a.Cell.List.Select=a.Cell.List.extend({initialize:function(){a.Cell.List.prototype.initialize.apply(this,arguments)},eventHandler:{click:"onClick","change select":"onChange"},getContentHtml:function(a){var b=this.grid.columnModel.getColumnModel(a.columnName),c="";c+='<select name="'+e.getUniqueKey()+'">';for(var d=0,f=b.editOption.list;d<f.length;d++)c+="<option ",c+='value="'+f[d].value+'"',a.value==f[d].value&&(c+=" selected"),c+=" >",c+=f[d].text,c+="</option>";return c+="</select>"},setElementAttribute:function(a,b){b.find("select").val(a.value)},onClick:function(){},onChange:function(a){var b=$(a.target),c=this._getCellAddr(b);this.grid.setValue(c.rowKey,c.columnName,b.val())}}),a.Cell.List.Button=a.Cell.List.extend({initialize:function(){a.Cell.List.prototype.initialize.apply(this,arguments)},eventHandler:{click:"onClick","change input":"onChange"},template:{input:_.template('<input type="<%=type%>" name="<%=name%>" id="<%=id%>" value="<%=value%>" <%=checked%>>'),label:_.template('<label for="<%=id%>" style="margin-right:10px"><%=text%></label>')},getContentHtml:function(a){for(var b,c=this.grid.columnModel.getColumnModel(a.columnName),d=a.value,f=(""+d).split(","),g="",h=e.getUniqueKey(),i=0,j=c.editOption.list;i<j.length;i++)b=h+"_"+j[i].value,g+=this.template.input({type:c.editOption.type,name:h,id:b,value:j[i].value,checked:-1===$.inArray(""+j[i].value,f)?"":"checked"}),j[i].text&&(g+=this.template.label({id:b,text:j[i].text}));return g},setElementAttribute:function(){},_getEditType:function(a){var b=this._getColumnName(a),c=this.grid.columnModel.getColumnModel(b),d=c.editOption.type;return d},onClick:function(){},_getCheckedList:function(a){for(var b=a.closest("td").find("input[type="+this._getEditType(a)+"]:checked"),c=[],d=0;d<b.length;d++)c.push(b.eq(d).val());return c},onChange:function(a){var b=$(a.target),c=this._getCellAddr(b);this.grid.setValue(c.rowKey,c.columnName,this._getCheckedList(b))},_getInputEl:function(a){return this.$el.find("input[type="+this.type+'][value="'+a+'"]')}}),a.Cell.Normal=a.Cell.Interface.extend({initialize:function(){a.Cell.Interface.prototype.initialize.apply(this,arguments)},getContentHtml:function(a){return a.value},setElementAttribute:function(){}}),a.Cell.MainButton=a.Cell.Interface.extend({shouldRenderList:["isEditable","optionList"],eventHandler:{mousedown:"_onMouseDown","change input":"_onChange"},initialize:function(){a.Cell.Interface.prototype.initialize.apply(this,arguments)},template:_.template('<input type="<%=type%>" name="<%=name%>" <%=checked%>/>'),getContentHtml:function(a){return this.template({type:this.grid.option("selectType"),name:this.grid.id,checked:a.value?"checked":""})},setElementAttribute:function(a,b){b.find("input").prop("checked",!!a.value)},getAttributes:function(){return this.getAttributesString({align:"center"})},_onChange:function(a){var b=$(a.target),c=this._getRowKey(b),d=this._getColumnName(b);this.grid.setValue(c,d,b.prop("checked"))},_onMouseDown:function(a){var b=$(a.target);b.is("input")||b.find("input").trigger("click")}}),a.Cell.Text=a.Cell.Interface.extend({shouldRenderList:["isEditable","optionList"],initialize:function(){a.Cell.Interface.prototype.initialize.apply(this,arguments)},template:_.template('<input type="text" value="<%=value%>" name="<%=name%>" />'),eventHandler:{"blur input":"onBlur"},getContentHtml:function(a){return this.template({value:e.encodeHTMLEntity(a.value),name:e.getUniqueKey(),checked:a.value?"checked":""})},setElementAttribute:function(){},onBlur:function(a){var b=$(a.target),c=this._getRowKey(b),d=this._getColumnName(b);console.log(b.val()),this.grid.setValue(c,d,b.val())}}),a.Extra.Log=a.Base.extend({events:{"click input":"clear"},initialize:function(){a.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({maxCount:20,logs:[],buffer:"",lastTime:-1,timeoutIdForLogs:0,width:500,height:200,opacity:.8})},activate:function(){this.grid.option("debug")===!0&&this.listenTo(this.grid,"afterRender",this.appendTo,this)},appendTo:function(){this.grid.$el.append(this.render().el)},render:function(){return this.$el.css({position:"absolute",right:"25px",top:"25px",opacity:this.opacity,background:"yellow",width:this.width+"px",height:this.height+"px",overflow:"auto"}),this},clear:function(){},write:function(a){this.buffer||(this.buffer=""),clearTimeout(this.timeoutIdForLogs);var b=this.buffer,c=new Date,d="["+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()+"] ",e=0;this.lastTime>0&&(e=c-this.lastTime),this.lastTime=c;var f=b.split("<br>");f.length>this.maxCount&&f.pop(),f.unshift("<b>"+d+a+" :elapsed ["+e+"]</b>"),this.buffer=f.join("<br>"),this.timeoutIdForLogs=setTimeout($.proxy(function(){this.$el.html(this.buffer)},this),100)}}),a.Extra.Selection=a.Base.extend({events:{},initialize:function(b){a.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:b&&b.whichSide||"R",lside:null,rside:null,range:{column:[0,1],row:[2,3]}})},activate:function(){this.listenTo(this.grid.view.rside,"afterRender",this.appendToRside,"a"),this.listenTo(this.grid.view.lside,"afterRender",this.appendToLside,"b")},appendToRside:function(){this.rside=this.appendTo(this.grid.view.rside.body,a.Extra.Selection.Layer.Rside),this.show()},appendToLside:function(){this.lside=this.appendTo(this.grid.view.lside.body,a.Extra.Selection.Layer.Lside)},appendTo:function(){},startSelection:function(a,b){this.range.row[0]=this.range.row[1]=a,this.range.column[0]=this.range.column[1]=b},updateSelectionRange:function(a,b){this.range.row[1]=a,this.range.column[1]=b},endSelection:function(){this.range.row[0]=this.range.row[1]=this.range.column[0]=this.range.column[1]=-1},show:function(){var a=this.grid.dimensionModel.get("rowHeight"),b=Math.min.apply(Math,this.range.row),c=Math.max.apply(Math,this.range.row),d=Math.min.apply(Math,this.range.column),f=Math.max.apply(Math,this.range.column),g=e.getTBodyHeight(b,a),h=e.getTBodyHeight(c-b,a)-3;console.log("this.lside.$el",this.lside),this.lside.show(b,c,d,f),this.rside.show(b,c,d,f),this.lside.$el.css({top:g+"px",width:"100px",height:h+"px",display:"block"})}}),a.Extra.Selection.Layer=a.Base.extend({tagName:"div",className:"selection_layer",initialize:function(b){a.Base.prototype.initialize.apply(this,arguments),this.listenTo(this.grid.renderModel,"change:scrollTop",this._onScrollTopChange,this),this.listenTo(this.grid.renderModel,"beforeRefresh",this._onBeforeRefresh,this),this.listenTo(this.grid.renderModel,"change:top",this._onTopChange,this),this.setOwnProperties({columnWidthList:b.columnWidthList})},_onScrollTopChange:function(){},_onBeforeRefresh:function(){},_onTopChange:function(){},render:function(){return console.log("@@Selection layer render"),this}}),a.Extra.Selection.Layer.Lside=a.Extra.Selection.Layer.extend({initialize:function(){a.Extra.Selection.Layer.prototype.initialize.apply(this,arguments),console.log("LSIDE : ",this.columnWidthList)},_onScrollTopChange:function(){},_onBeforeRefresh:function(){},_onTopChange:function(){console.log(this.$el.length)},show:function(){}}),a.Extra.Selection.Layer.Rside=a.Extra.Selection.Layer.extend({initialize:function(){a.Extra.Selection.Layer.prototype.initialize.apply(this,arguments),console.log("RSIDE : ",this.columnWidthList)},_onScrollTopChange:function(){},_onBeforeRefresh:function(){},_onTopChange:function(){},show:function(){}});var f=({plugins:{clipboard:a.Plugin.Clipboard}},window.Grid=a.Base.extend({scrollBarSize:17,lside:null,rside:null,footer:null,cellFactory:null,events:{click:"_onClick",mousedown:"_onMouseDown"},initialize:function(b){a.Base.prototype.initialize.apply(this,arguments);var c=e.getUniqueKey();this.__instance[c]=this;var d={debug:!1,columnFixIndex:0,columnModelList:[],keyColumnName:null,selectType:"",autoNumbering:!0,headerHeight:35,rowHeight:27,displayRowCount:10,minimumColumnWidth:50,notUseSmartRendering:!1,columnMerge:[],minimumWidth:300,scrollX:!0,scrollY:!0,useDataCopy:!0};b=$.extend(d,b),this.setOwnProperties({columnModel:null,dataModel:null,renderModel:null,layoutModel:null,view:{lside:null,rside:null,footer:null,clipboard:null},id:c,options:b}),this._initializeModel(),this._initializeListener(),this._initializeView(),this._initializeScrollBar(),this.render()},_initializeListener:function(){},_onWidthChange:function(a){this.$el.css("width",a+"px")},option:function(a,b){return void 0===b?this.options[a]:(this.options[a]=b,this)},_onClick:function(){},_onMouseDown:function(a){var b=$(a.target);b.is("input")||b.is("a")||b.is("button")||b.is("select")||(a.preventDefault(),this.trigger("mousedown",a))},_initializeModel:function(){this.columnModel=new c.ColumnModel({grid:this,keyColumnName:this.option("keyColumnName"),columnFixIndex:this.option("columnFixIndex")}),this.setColumnModelList(this.option("columnModelList")),this.dimensionModel=new b.Dimension({grid:this,width:this.$el.width(),height:this.$el.height(),rowHeight:this.option("rowHeight")}),this.dataModel=new c.RowList({grid:this}),this.renderModel=this.option("notUseSmartRendering")===!0?new b.Renderer({grid:this}):new b.Renderer.Smart({grid:this}),this.cellFactory=this.createView(a.CellFactory,{grid:this})},_initializeView:function(){this.cellFactory=this.createView(a.CellFactory,{grid:this}),this.view.lside=this.createView(a.Layout.Frame.Lside,{grid:this}),this.view.rside=this.createView(a.Layout.Frame.Rside,{grid:this}),this.view.footer=this.createView(a.Layout.Footer,{grid:this}),this.view.clipboard=this.createView(a.Clipboard,{grid:this})},_initializeScrollBar:function(){},render:function(){this.trigger("beforeRender"),this.$el.attr("instanceId",this.id).append(this.view.lside.render().el).append(this.view.rside.render().el).append(this.view.footer.render().el).append(this.view.clipboard.render().el),this.trigger("afterRender")},setRowList:function(a){this.dataModel.set(a,{parse:!0})},setValue:function(a,b,c,d){this.dataModel.setValue(a,b,c,d)},setColumnValue:function(a,b,c){this.dataModel.setColumnValue(a,b,c)},appendRow:function(a){this.dataModel.append(a)},prependRow:function(a){this.dataModel.prepend(a)},setColumnIndex:function(a){this.option({columnFixIndex:a}),this.columnModel.set({columnFixIndex:a})},setColumnModelList:function(a){this.columnModel.set("columnModelList",a)},sort:function(a){this.dataModel.sortByField(a)},getRowList:function(){return this.dataModel.toJSON()},getCheckedRowList:function(){return this.dataModel.where({_button:!0})},getCheckedRowKeyList:function(){var a=[];return _.each(this.dataModel.where({_button:!0}),function(b){a.push(b.get("rowKey"))},this),a},getModifiedRowList:function(){return this.dataModel.getModifiedRowList()},disableCell:function(){},enableCell:function(){},setEditOptionList:function(){},checkRow:function(a){this.setValue(a,"_button",!0)},checkAllRow:function(){this.dataModel.setColumnValue("_button",!0)},uncheckAllRow:function(){this.dataModel.setColumnValue("_button",!1)},_getDataCollection:function(a){return this.renderModel.get(a)},destroy:function(){this.destroyChildren(),this.$el.removeAttr("instanceId"),this.stopListening();for(var a in this)this[a]=null,delete this[a]}}));f.prototype.__instance={},f.getInstanceById=function(a){return this.prototype.__instance[a]}}();