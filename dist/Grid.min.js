!function(){!function(ne){"use strict";ne||(ne=window.ne={}),ne.util||(ne.util=window.ne.util={});var ajax={};ajax._ajaxRequestData={},ajax.request=function(a,b){var c=a;if(!c)return alert("요청을 보낼 URL을 입력해 주시기 바랍니다."),!1;var d=ajax.util._getRandomId();b=b||{},b._complete=b.complete,b._success=b.success,b._error=b.error,b=$.extend(b,{url:c,data:b.data||{},type:b.type||"post",dataType:b.dataType||"json",complete:$.proxy(this._onAjaxComplete,this,d),success:$.proxy(this._onAjaxSuccess,this,d),error:$.proxy(this._onAjaxError,this,d)});var e,f;for(var g in this._ajaxRequestData)if(e=b.url===this._ajaxRequestData[g].url,f=$.compareJSON(this._ajaxRequestData[g].data,b.data),e&&f)return!1;this._ajaxRequestData[d]=ajax.util.cloningObject(b),$.ajax(b)},ajax._onAjaxComplete=function(a,b,c){var d=this._ajaxRequestData[a];if(!d)throw new Error("Ajax 요청 정보가 없습니다.");d._complete&&$.isFunction(d._complete)&&d._complete(c,b),delete this._ajaxRequestData[a]},ajax._onAjaxSuccess=function(a,b,c,d){var e=this._ajaxRequestData[a];if(!e)throw new Error("Ajax 요청 정보가 없습니다.");var f=!0;e._success&&$.isFunction(e._success)&&(f=e._success(b,c,d)),f!==!1&&b&&b.data&&(b.data.message&&alert(b.data.message),b.data.redirectUrl&&(location.href=b.data.redirectUrl),b.data.closeWindow&&ajax.util.close(!0))},ajax._onAjaxError=function(a,b,c,d){var e=this._ajaxRequestData[a];if(!e)throw new Error("Ajax 요청 정보가 없습니다.");var f=!0;e._error&&$.isFunction(e._error)&&(f=e._error(b,c,d))},ajax.util={},ajax.util.cloningObject=function(sourceTarget){var constructor,destinationTarget,x,y;if("object"==typeof sourceTarget&&(constructor=this.getConstructorName(sourceTarget))){if(destinationTarget=eval("new "+constructor+"()"),sourceTarget.prototype)for(x in sourceTarget.prototype)destinationTarget.prototype[x]=this.cloningObject(sourceTarget.prototype[x]);for(y in sourceTarget)destinationTarget[y]=sourceTarget[y]instanceof RegExp?eval(sourceTarget[y].toString()):this.cloningObject(sourceTarget[y]);return destinationTarget}return destinationTarget=sourceTarget},ajax.util.getConstructorName=function(a){if(a&&a.constructor){var b=a.constructor.toString(),c=b.match(/function ([^\(]*)/);return c&&c[1]||null}return null},ajax.util._getRandomId=function(){return String(parseInt(1e10*Math.random(),10))},ajax.util.close=function(a,b){var c=b||window;ne.util.isTruthy(a)&&$(c).off("beforeunload"),c.closed||(c.opener=window.location.href,c.close())},ne.util.ajax=ajax}(window.ne),function(a){"use strict";a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var b,c,d={chrome:!1,firefox:!1,safari:!1,msie:!1,others:!1,version:0},e=window.navigator,f=e.appName.replace(/\s/g,"_"),g=e.userAgent,h=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),i=/Trident.*rv\:11\./,j={firefox:/Firefox\/(\d+)\./,chrome:/Chrome\/(\d+)\./,safari:/Version\/([\d\.]+)\sSafari\/(\d+)/},k={Microsoft_Internet_Explorer:function(){d.msie=!0,d.version=parseFloat(g.match(h)[1])},Netscape:function(){var a=!1;if(i.exec(g))d.msie=!0,d.version=11;else for(b in j)if(j.hasOwnProperty(b)&&(c=g.match(j[b]),c&&c.length>1)){d[b]=a=!0,d.version=parseFloat(c[1]||0);break}a||(d.others=!0)}};k[f](),a.util.browser=d}(window.ne),function(a){"use strict";function b(a,b,c){for(var d=0,e=a.length;e>d&&b.call(c||null,a[d],d,a)!==!1;d++);}function c(a,b,c){var d;for(d in a)if(a.hasOwnProperty(d)&&b.call(c||null,a[d],d,a)===!1)break}function d(b,c,d){var e,f;if(a.util.isArray(b))for(e=0,f=b.length;f>e;e++)c.call(d||null,b[e],e,b);else a.util.forEachOwnProperties(b,c,d)}function e(b,c,d){var e=[];return a.util.forEach(b,function(){e.push(c.apply(d||null,arguments))}),e}function f(b,c,d){var e,f,g,h=0;for(a.util.isArray(b)||(e=a.util.keys(b)),f=e?e.length:b.length,g=b[e?e[h++]:h++];f>h;h++)g=c.call(d||null,g,b[e?e[h]:h]);return g}function g(a){var c;try{c=Array.prototype.slice.call(a)}catch(d){c=[],b(a,function(a){c.push(a)})}return c}a||(a=window.ne={}),a.util||(a.util=window.ne.util={}),a.util.forEachOwnProperties=c,a.util.forEachArray=b,a.util.forEach=d,a.util.toArray=g,a.util.map=e,a.util.reduce=f}(window.ne),function(a){"use strict";function b(){this._events={}}a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var c={on:function(a,b,c){this._toggle(!0,a,b,c)},off:function(b,c,d){return a.util.isExisty(b)?void this._toggle(!1,b,c,d):void(this._events=null)},_toggle:function(b,c,d,e){var f=b?"_on":"_off",g=this[f];a.util.isObject(c)?a.util.forEachOwnProperties(c,function(a,b){g.call(this,b,a,d)},this):(c=c.split(" "),a.util.forEach(c,function(a){g.call(this,a,d,e)},this))},_on:function(b,c,d){var e=this._events=this._events||{},f=d&&d!==this&&a.util.stamp(d);if(f){var g=b+"_idx",h=b+"_len",i=e[g]=e[g]||{},j=a.util.stamp(c)+"_"+f;i[j]||(i[j]={fn:c,ctx:d},e[h]=(e[h]||0)+1)}else e[b]=e[b]||[],e[b].push({fn:c})},_off:function(b,c,d){var e=this._events,f=b+"_idx",g=b+"_len";if(e){var h,i,j=d&&d!==this&&a.util.stamp(d);j?(i=a.util.stamp(c)+"_"+j,h=e[f],h&&h[i]&&(h[i]=null,e[g]-=1)):(h=e[b],h&&a.util.forEach(h,function(b,d){return a.util.isExisty(b)&&b.fn===c?(h.splice(d,1),!0):void 0}))}},invoke:function(b,c){if(!this.hasListener(b))return this;var d=a.util.extend({},c,{type:b,target:this}),e=this._events;if(e){var f,g=e[b+"_idx"],h=!0;return e[b]&&(f=e[b].slice(),a.util.forEach(f,function(a){h=h&&a.fn.call(this,d)!==!1},this)),a.util.forEachOwnProperties(g,function(a){h=h&&a.fn.call(a.ctx,d)!==!1}),h}},fire:function(a,b){return this.invoke(a,b),this},hasListener:function(b){var c=this._events,d=a.util.isExisty;return d(c)&&(d(c[b])||c[b+"_len"])},getListenerLength:function(b){var c,d,e=this._events,f=b+"_len",g=0;return a.util.isExisty(e)?(c=e[b],d=e[f],g+=a.util.isExisty(c)&&a.util.isArray(c)?c.length:0,g+=a.util.isExisty(d)?d:0):0},once:function(b,c,d){function e(){c.apply(d,arguments),f.off(b,e,d)}var f=this;return a.util.isObject(b)?void a.util.forEachOwnProperties(b,function(a){this.once(a,b[a],c)},this):void this.on(b,e,d)}};b.prototype=c,b.prototype.constructor=b,b.mixin=function(b){a.util.extend(b.prototype,c)},a.util.CustomEvents=b}(window.ne),function(a){"use strict";a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var b=function(b,c){var d;return c||(c=b,b=null),d=c.init||function(){},b&&a.util.inherit(d,b),c.hasOwnProperty("static")&&(a.util.extend(d,c.static),delete c.static),a.util.extend(d.prototype,c),d};a.util.defineClass=b}(window.ne),function(a){"use strict";function b(b){return a.util.forEach(b,function(a,c){b[c]=String(a)},this),b}function c(b){var c={},d=b.serializeArray();return a.util.forEach(d,function(b){var d=b.value,e=b.name;a.util.isExisty(c[e])?(c[e].push||(c[e]=[c[e]]),c[e].push(d||"")):c[e]=d||""},this),c}function d(a,b){var c;return a&&a.length&&(c=b?a.prop("elements")[b+""]:a.prop("elements")),$(c)}function e(b,c){a.util.forEachOwnProperties(c,function(a,c){f(b,c,a)},this)}function f(b,c,e){var f,g=d(b,c);g&&(a.util.isArray(e)||(e=String(e)),g=a.util.isHTMLTag(g)?[g]:g,g=a.util.toArray(g),a.util.forEach(g,function(a){f=h[a.type]?a.type:"defaultAction",h[f](a,e)},this))}function g(a){a.focus();var b=a.value.length;if(a.setSelectionRange)a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}}a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var h={radio:function(a,b){a.checked=a.value===b},checkbox:function(c,d){c.checked=a.util.isArray(d)?-1!==$.inArray(c.value,b(d)):c.value===d},"select-one":function(b,c){var d=a.util.toArray(b.options),e=-1;a.util.forEach(d,function(a,b){return a.value===c||a.text===c?(e=b,!1):void 0},this),b.selectedIndex=e},"select-multiple":function(c,d){var e=a.util.toArray(c.options);a.util.isArray(d)?(d=b(d),a.util.forEach(e,function(a){a.selected=-1!==$.inArray(a.value,d)||-1!==$.inArray(a.text,d)},this)):this["select-one"].apply(this,arguments)},defaultAction:function(a,b){a.value=b}};a.util.getFormElement=d,a.util.getFormData=c,a.util.setFormData=e,a.util.setFormElementValue=f,a.util.setCursorToEnd=g}(window.ne),function(a){"use strict";function b(a,b){var c=Array.prototype.slice;if(a.bind)return a.bind.apply(a,c.call(arguments,1));var d=c.call(arguments,2);return function(){return a.apply(b,d.length?d.concat(c.call(arguments)):arguments)}}a||(a=window.ne={}),a.util||(a.util=window.ne.util={}),a.util.bind=b}(window.ne),function(a){"use strict";function b(a){this.length=0,a&&this.setObject(a)}a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var c="å";b.prototype.set=function(a,b){2===arguments.length?this.setKeyValue(a,b):this.setObject(a)},b.prototype.setKeyValue=function(a,b){this.has(a)||(this.length+=1),this[this.encodeKey(a)]=b},b.prototype.setObject=function(b){var c=this;a.util.forEachOwnProperties(b,function(a,b){c.setKeyValue(b,a)})},b.prototype.encodeKey=function(a){return c+a},b.prototype.decodeKey=function(a){var b=a.split(c);return b[b.length-1]},b.prototype.get=function(a){return this[this.encodeKey(a)]},b.prototype.has=function(a){return this.hasOwnProperty(this.encodeKey(a))},b.prototype.remove=function(b){return arguments.length>1&&(b=a.util.toArray(arguments)),a.util.isArray(b)?this.removeByKeyArray(b):this.removeByKey(b)},b.prototype.removeByKey=function(a){var b=this.has(a)?this.get(a):null;return null!==b&&(delete this[this.encodeKey(a)],this.length-=1),b},b.prototype.removeByKeyArray=function(b){var c=[],d=this;return a.util.forEach(b,function(a){c.push(d.removeByKey(a))}),c},b.prototype.removeAll=function(){var a=this;this.each(function(b,c){a.remove(c)})},b.prototype.each=function(b){var d,e=this;a.util.forEachOwnProperties(this,function(a,f){return f.charAt(0)===c&&(d=b(a,e.decodeKey(f))),d===!1?d:void 0})},b.prototype.keys=function(){var a=[],b=this;return this.each(function(c,d){a.push(b.decodeKey(d))}),a},b.prototype.find=function(a){var b=[];return this.each(function(c,d){a(c,d)&&b.push(c)}),b},a.util.HashMap=b}(window.ne),function(a){"use strict";function b(){function a(){}return function(b){return a.prototype=b,new a}}function c(b,c){var d=a.util.createObject(c.prototype);d.constructor=b,b.prototype=d}a||(a=window.ne={}),a.util||(a.util=window.ne.util={}),a.util.createObject=b(),a.util.inherit=c}(window.ne),function(a){"use strict";a||(a=window.ne={}),a.util||(a.util=window.ne.util={})}(window.ne),function(a){"use strict";function b(a){var b,c,d,e,f=Object.prototype.hasOwnProperty;for(d=1,e=arguments.length;e>d;d++){b=arguments[d];for(c in b)f.call(b,c)&&(a[c]=b[c])}return a}function c(a){return a.__fe_id=a.__fe_id||++e,a.__fe_id}function d(){e=0}a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var e=0,f=function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b);return c};a.util.extend=b,a.util.stamp=c,a.util._resetLastId=d,a.util.keys=Object.keys||f}(window.ne),function(a){"use strict";a||(a=window.ne={}),a.util||(a.util=window.ne.util={})}(window.ne),function(a){"use strict";function b(a){var b={"&quot;":'"',"&amp;":"&","&lt;":"<","&gt;":">","&#39;":"'","&nbsp;":" "};return a.replace(/&amp;|&lt;|&gt;|&quot;|&#39;|&nbsp;/g,function(a){return b[a]?b[a]:a})}function c(a){var b={'"':"quot","&":"amp","<":"lt",">":"gt","'":"#39"};return a.replace(/[<>&"']/g,function(a){return b[a]?"&"+b[a]+";":a})}function d(a){return/[<>&"']/.test(a)}a||(a=window.ne={}),a.util||(a.util=window.ne.util={}),a.util.decodeHTMLEntity=b,a.util.encodeHTMLEntity=c,a.util.hasEncodableString=d}(window.ne),function(a){"use strict";function b(b,e){if(arguments.length<2)return!d(b)&&!c(b);if(!i(b))return!1;if(e=l(e)?e.split("."):e,!h(e))return!1;e.unshift(b);var f=a.util.reduce(e,function(a,b){return a?a[b]:void 0});return!d(f)&&!c(f)}function c(a){return void 0===a}function d(a){return null===a}function e(a){return b(a)&&a!==!1}function f(a){return!e(a)}function g(a){var c=b(a)&&("[object Arguments]"===r.call(a)||"callee"in a);return c}function h(a){return"[object Array]"===r.call(a)}function i(a){return a===Object(a)}function j(a){return"[object Function]"===r.call(a)}function k(a){return"[object Number]"===r.call(a)}function l(a){return"[object String]"===r.call(a)}function m(a){return"[object Boolean]"===r.call(a)}function n(a){return"object"==typeof HTMLElement?a&&(a instanceof HTMLElement||!!a.nodeType):!(!a||!a.nodeType)}function o(a){return"object"==typeof HTMLElement?a&&a instanceof HTMLElement:!(!a||!a.nodeType||1!==a.nodeType)}function p(c){var d=!1;return b(c)?h(c)||g(c)?0===c.length:i(c)&&!j(c)?(a.util.forEachOwnProperties(c,function(){return d=!0,!1}),!d):!0:!0}function q(a){return!p(a)}a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var r=Object.prototype.toString;a.util.isExisty=b,a.util.isUndefined=c,a.util.isNull=d,a.util.isTruthy=e,a.util.isFalsy=f,a.util.isArguments=g,a.util.isArray=Array.isArray||h,a.util.isObject=i,a.util.isFunction=j,a.util.isNumber=k,a.util.isString=l,a.util.isBoolean=m,a.util.isHTMLNode=n,a.util.isHTMLTag=o,a.util.isEmpty=p,a.util.isNotEmpty=q}(window.ne),function(a){"use strict";function b(b){if(!a.util.isExisty(b))return void 0;for(var c,d=b.split("."),f=0,g=d.length,h=e;g>f&&(c=d[f],"undefined"!=typeof h);f++)h=h[c];return h}function c(b,d){if("string"!=typeof b)a.util.forEach(b,function(a,b){c(b,a)});else if("undefined"!=typeof d)for(var f,g=b.split("."),h=0,i=g.length,j=e;i>h;h++){if(f=g[h],h===i-1)return j[f]=d;"undefined"==typeof j[f]&&(j[f]={}),j=j[f]}}function d(b){if(a.util.isExisty(b)){if(!a.util.isObject(b)||a.util.isFunction(b)||a.util.isArray(b))throw new Error("variable: 전역변수 공간은 object 형태의 데이터로만 설정이 가능합니다.");e=b}else e={}}a||(a=window.ne={}),a.util||(a.util=window.ne.util={});var e={};a.util.variable={get:b,set:c,reset:d}}(window.ne),function(a){"use strict";a||(a=window.ne={}),a.util||(a.util=window.ne.util={})}(window.ne);var ne=window.ne||{};ne.Component=ne.Component||{},ne.Component.Pagination=function(a,b){var c={itemCount:10,itemPerPage:10,pagePerPageList:10,page:1,moveUnit:"pagelist",isCenterAlign:!1,insertTextNode:"",classPrefix:"",firstItemClassName:"first-child",lastItemClassName:"last-child",pageTemplate:'<a href="#">{=page}</a>',currentPageTemplate:"<strong>{=page}</strong>"};this._options=$.extend(c,a),this._eventHandler={},this._view=new ne.Component.PaginationView(this._options,b),this._view.attachEvent("click",$.proxy(this._onClickPageList,this)),this.movePageTo(this._getOption("page"),!1)},ne.Component.Pagination.prototype.reset=function(a){var b=null!==a&&void 0!==a;b||(a=this._getOption("itemCount")),this._setOption("itemCount",a),this.movePageTo(1,!1)},ne.Component.Pagination.prototype._getOption=function(a){return this._options[a]},ne.Component.Pagination.prototype.movePageTo=function(a,b){b=!(!b&&void 0!==b),a=this._convertToAvailPage(a),this._currentPage=a,(!b||this.fireEvent("beforeMove",{page:a}))&&(this._paginate(a),b&&this.fireEvent("afterMove",{page:a}))},ne.Component.Pagination.prototype._setOption=function(a,b){this._options[a]=b},ne.Component.Pagination.prototype.getCurrentPage=function(){return this._currentPage||this._options.page},ne.Component.Pagination.prototype.getIndexOfFirstItem=function(a){return this._getOption("itemPerPage")*(a-1)+1},ne.Component.Pagination.prototype._getLastPage=function(){return Math.ceil(this._getOption("itemCount")/this._getOption("itemPerPage"))},ne.Component.Pagination.prototype._getPageIndex=function(a){if(this._getOption("isCenterAlign")){var b=Math.floor(this._getOption("pagePerPageList")/2),c=a-b;return c=Math.max(c,1),c=Math.min(c,this._getLastPage())}return Math.ceil(a/this._getOption("pagePerPageList"))},ne.Component.Pagination.prototype._getRelativePage=function(a){var b=null,c="page"===this._getOption("moveUnit"),d=this._getPageIndex(this.getCurrentPage());switch(a){case"pre_end":b=1;break;case"next_end":b=this._getLastPage();break;case"pre":b=c?this.getCurrentPage()-1:(d-1)*this._getOption("pagePerPageList");break;case"next":b=c?this.getCurrentPage()+1:d*this._getOption("pagePerPageList")+1}return b},ne.Component.Pagination.prototype._convertToAvailPage=function(a){var b=this._getLastPage();return a=Math.max(a,1),a=Math.min(a,b)},ne.Component.Pagination.prototype._paginate=function(a){this._view.empty();var b={};b.lastPage=this._getLastPage(),b.currentPageIndex=this._getPageIndex(a),b.lastPageListIndex=this._getPageIndex(b.lastPage),b.page=a,this._view.update(b,a)},ne.Component.Pagination.prototype._onClickPageList=function(a){a.preventDefault();var b,c=null,d=$(a.target);if(this._view.isIn(d,this._getOption("$pre_endOn")))c=this._getRelativePage("pre_end");else if(this._view.isIn(d,this._getOption("$preOn")))c=this._getRelativePage("pre");else if(this._view.isIn(d,this._getOption("$nextOn")))c=this._getRelativePage("next");else if(this._view.isIn(d,this._getOption("$lastOn")))c=this._getRelativePage("next_end");else{if(b=this._view.getPageElement(d),!b||!b.length)return;c=parseInt(b.text(),10)}var e=this.fireEvent("click",{page:c});e&&this.movePageTo(c)},ne.Component.Pagination.prototype.attach=function(a,b){if(1===arguments.length){var a,c;for(a in arguments[0])c=arguments[0][a],this.attach(a,c);return this}var d=this._eventHandler[a];return"undefined"==typeof d&&(d=this._eventHandler[a]=[]),d.push(b),this},ne.Component.Pagination.prototype.fireEvent=function(a,b){b=b||{};var c=this["on"+a],d=this._eventHandler[a]||[],e=$.isFunction(c),f=d.length>0;if(!e&&!f)return!0;d=d.concat(),b.eventType=a,b._aExtend||(b._aExtend=[],b.stop=function(){b._aExtend.length>0&&(b._aExtend[b._aExtend.length-1].canceled=!0)}),b._aExtend.push({type:a,canceled:!1});var g,h,i=[b];for(g=2,h=arguments.length;h>g;g++)i.push(arguments[g]);if(e&&c.apply(this,i),f){var j;for(g=0;j=d[g];g++)j.apply(this,i)}return!b._aExtend.pop().canceled};var ne=ne||{};ne.Component=ne.Component||{},ne.Component.PaginationView=function(a,b){this._element=b,this._options=a,this._elementSelector={},this._cachedElement={},this._eventData={},$.extend(a,{$pre_endOn:a.$pre_endOn||$("a."+this._wrapPrefix("pre_end"),this._element),$preOn:a.$preOn||$("a."+this._wrapPrefix("pre"),this._element),$nextOn:a.$nextOn||$("a."+this._wrapPrefix("next"),this._element),$lastOn:a.$lastOn||$("a."+this._wrapPrefix("next_end"),this._element),$pre_endOff:a.$pre_endOff||$("span."+this._wrapPrefix("pre_end"),this._element),$preOff:a.$preOff||$("span."+this._wrapPrefix("pre"),this._element),$nextOff:a.$nextOff||$("span."+this._wrapPrefix("next"),this._element),$lastOff:a.$lastOff||$("span."+this._wrapPrefix("next_end"),this._element)}),this._element.addClass(this._wrapPrefix("loaded"))},ne.Component.PaginationView.prototype.update=function(a){this._addTextNode(),this._setPageResult(a.lastPage);var b=this._options,c=this._getEdge(a),d=c.left,e=c.right;a.leftPageNumber=d,a.rightPageNumber=e,"page"===b.moveUnit&&(a.currentPageIndex=a.page,a.lastPageIndex=a.lastPage),this._setFirst(a),this._setPrev(a),this._setPageNumbers(a),this._setNext(a),this._setLast(a)},ne.Component.PaginationView.prototype.isIn=function(a,b){return b?a[0]===b[0]?!0:$.contains(b,a):!1},ne.Component.PaginationView.prototype.getBaseElement=function(){return this._element},ne.Component.PaginationView.prototype.empty=function(){var a=this._options,b=a.$pre_endOn,c=a.$preOn,d=a.$nextOn,e=a.$lastOn,f=a.$pre_endOff,g=a.$preOff,h=a.$nextOff,i=a.$lastOff;a.$pre_endOn=this._clone(b),a.$preOn=this._clone(c),a.$lastOn=this._clone(e),a.$nextOn=this._clone(d),a.$pre_endOff=this._clone(f),a.$preOff=this._clone(g),a.$lastOff=this._clone(i),a.$nextOff=this._clone(h),this._pageItemList=[],this._element.empty()},ne.Component.PaginationView.prototype.getPageElement=function(a){var b,c,d;for(b=0,c=this._pageItemList.length;c>b;b++)if(d=this._pageItemList[b],this.isIn(a,d))return d;return null},ne.Component.PaginationView.prototype.attachEvent=function(a,b){var c=this._element,d="string"==typeof c&&this._elementSelector[c];if(d&&(c=this._getElement(c,!0)),c&&a&&b){var e=a+"_"+parseInt(1e7*Math.random(),10);return $(c).bind(a,null,b),this._eventData[e]={targetElement:c,eventType:a,callback:b},e}},ne.Component.PaginationView.prototype.getElement=function(){return this._element},ne.Component.PaginationView.prototype._wrapPrefix=function(a){var b=this._options.classPrefix;return b?b+a.replace(/_/g,"-"):a},ne.Component.PaginationView.prototype._addTextNode=function(){var a=this._options.insertTextNode;this._element.append(document.createTextNode(a))},ne.Component.PaginationView.prototype._clone=function(a){return a&&a.length&&a.get(0).cloneNode?$(a.get(0).cloneNode(!0)):a},ne.Component.PaginationView.prototype._setPageResult=function(a){0===a?this._element.addClass(this._wrapPrefix("no-result")):1===a?this._element.addClass(this._wrapPrefix("only-one")).removeClass(this._wrapPrefix("no-result")):this._element.removeClass(this._wrapPrefix("only-one")).removeClass(this._wrapPrefix("no-result"))},ne.Component.PaginationView.prototype._getEdge=function(a){var b,c,d,e=this._options;return e.isCenterAlign?(d=Math.floor(e.pagePerPageList/2),b=a.page-d,b=Math.max(b,1),c=b+e.pagePerPageList-1,c>a.lastPage&&(b=a.lastPage-e.pagePerPageList+1,b=Math.max(b,1),c=a.lastPage)):(b=(a.currentPageIndex-1)*e.pagePerPageList+1,c=a.currentPageIndex*e.pagePerPageList,c=Math.min(c,a.lastPage)),{left:b,right:c}},ne.Component.PaginationView.prototype._setFirst=function(a){var b=this._options;a.page>1?b.$pre_endOn&&(this._element.append(b.$pre_endOn),this._addTextNode()):b.$pre_endOff&&(this._element.append(b.$pre_endOff),this._addTextNode())},ne.Component.PaginationView.prototype._setPrev=function(a){var b=this._options;a.currentPageIndex>1?b.$preOn&&(this._element.append(b.$preOn),this._addTextNode()):b.$preOff&&(this._element.append(b.$preOff),this._addTextNode())},ne.Component.PaginationView.prototype._setNext=function(a){var b=this._options;a.currentPageIndex<a.lastPageListIndex?b.$nextOn&&(this._element.append(b.$nextOn),this._addTextNode()):b.$nextOff&&(this._element.append(b.$nextOff),this._addTextNode())},ne.Component.PaginationView.prototype._setLast=function(a){var b=this._options;a.page<a.lastPage?b.$lastOn&&(this._element.append(b.$lastOn),this._addTextNode()):b.$lastOff&&(this._element.append(b.$lastOff),this._addTextNode())},ne.Component.PaginationView.prototype._setPageNumbers=function(a){var b,c,d=a.leftPageNumber,e=a.rightPageNumber,f=this._options;for(c=d;e>=c;c++)c==a.page?b=$(f.currentPageTemplate.replace("{=page}",c.toString())):(b=$(f.pageTemplate.replace("{=page}",c.toString())),this._pageItemList.push(b)),c==d&&b.addClass(this._wrapPrefix(f.firstItemClassName)),c==e&&b.addClass(this._wrapPrefix(f.lastItemClassName)),this._element.append(b),this._addTextNode()};var View={CellFactory:null,Layout:{},Layer:{},Painter:{Row:null,Cell:{}}},Model={},Data={},Collection={},AddOn={},setOwnProperties=function(a){_.each(a,function(a,b){this[b]=a},this)};Model.Base=Backbone.Model.extend({initialize:function(a){var b=a&&a.grid||this.collection&&this.collection.grid||null;this.setOwnProperties({grid:b})},setOwnProperties:setOwnProperties}),Collection.Base=Backbone.Collection.extend({initialize:function(a,b){var c=b&&b.grid||this.collection&&this.collection.grid||null;this.setOwnProperties({grid:c})},clear:function(){return this.each(function(a){a.stopListening(),a=null}),this.reset([],{silent:!0}),this},setOwnProperties:setOwnProperties}),View.Base=Backbone.View.extend({initialize:function(a){var b=a&&a.grid||this.collection&&this.collection.grid||null;this.setOwnProperties({grid:b,__viewList:[]})},error:function(a){var b=function(){this.name="Grid Exception",this.message=a||"error"};return b.prototype=new Error,new b},setOwnProperties:setOwnProperties,createView:function(a,b){var c=new a(b);return this.addView(c),c},addView:function(a){return this.hasOwnProperty("__viewList")||this.setOwnProperties({__viewList:[]}),this.__viewList.push(a),a},destroy:function(){this.destroyChildren(),this.remove()},createEventData:function(a){var b=$.extend({},a);return b.stop=function(){this._isStoped=!0},b.isStopped=function(){return this._isStoped},b._isStoped=b._isStoped||!1,b},destroyChildren:function(){if(this.__viewList instanceof Array)for(;0!==this.__viewList.length;)this.__viewList.pop().destroy()}}),View.Base.Painter=View.Base.extend({eventHandler:{},initialize:function(){View.Base.prototype.initialize.apply(this,arguments),this.initializeEventHandler()},initializeEventHandler:function(){var a={};_.each(this.eventHandler,function(b,c){var d=c.split(" "),e=d[0],f=d[1]||"";a[e]={selector:f,handler:$.proxy(this[b],this)}},this),this.setOwnProperties({_eventHandler:a})},attachHandler:function(a){_.each(this._eventHandler,function(b,c){var d=b.handler,e=b.selector,f=a;e&&(f=a.find(e)),f.length>0&&f.on(c,d)},this)},detachHandler:function(a){_.each(this._eventHandler,function(b,c){var d=b.handler,e=b.selector,f=a;e&&(f=a.find(e)),f.length>0&&f.off(c,d)},this)},getHtml:function(){throw this.error("implement getHtml() method")}});var Util={getAttributesString:function(a){var b="";return _.each(a,function(a,c){b+=" "+c+'="'+a+'"'},this),b},sum:function(a){return _.reduce(a,function(a,b){return a+=b},0)},getHeight:function(a,b){return 0===a?a:a*(b+1)+1},getDisplayRowCount:function(a,b){return Math.ceil((a-1)/(b+1))},getRowHeight:function(a,b){return 0===a?0:Math.floor((b-1)/a)-1},isEqual:function(a,b){var c,d=function(a,b){var c,d=!0;for(c in a)if(a[c]!==b[c]){d=!1;break}return d};return typeof a!=typeof b?!1:ne.util.isArray(a)&&a.length!==b.length?!1:"object"==typeof a?(c=!d(a,b)||!d(b,a),!c):a!==b?!1:!0},stripTags:function(a){var b;return a=a.replace(/[\n\r\t]/g,""),ne.util.hasEncodableString(a)&&(/<img/i.test(a)?(b=a.match(/<img[^>]*\ssrc=[\"']?([^>\"']+)[\"']?[^>]*>/i),a=b?b[1]:""):a=a.replace(/<button.*?<\/button>/gi,""),a=$.trim(ne.util.decodeHTMLEntity(a.replace(/<\/?(?:h[1-5]|[a-z]+(?:\:[a-z]+)?)[^>]*>/gi,"")))),a},getUniqueKey:function(){var a=String(parseInt(1e10*Math.random(),10));return(new Date).getTime()+a},toQueryString:function(a){var b=[];return ne.util.forEach(a,function(a,c){"string"!=typeof a&&"number"!=typeof a&&(a=$.toJSON(a)),a=encodeURIComponent(a),b.push(c+"="+a)},this),b.join("&")},toQueryObject:function(a){var b=a.split("&"),c={};return ne.util.forEach(b,function(a){var b,d,e=a.split("=");b=e[0],d=decodeURIComponent(e[1]);try{d=$.parseJSON(d)}catch(f){}c[b]=d},this),c},convertValueType:function(a,b){return"string"===b?a.toString():"number"===b?+a:a}};Data.ColumnModel=Model.Base.extend({defaults:{keyColumnName:null,columnFixIndex:0,columnModelList:[],visibleList:[],hasNumberColumn:!0,selectType:"",columnModelMap:{},relationListMap:{}},initialize:function(){Model.Base.prototype.initialize.apply(this,arguments),this._setColumnModelList(this.get("columnModelList"),this.get("columnFixIndex")),this.on("change",this._onChange,this)},_initializeNumberColumn:function(a){var b=this.get("hasNumberColumn"),c={columnName:"_number",title:"No.",width:60};return b||(c.isHidden=!0),a=this._extendColumn(c,a)},_initializeButtonColumn:function(a){var b=this.get("selectType"),c={columnName:"_button",editOption:{type:b,list:[{value:"selected"}]},width:50};return"checkbox"===b?c.title='<input type="checkbox"/>':"radio"===b?c.title="선택":c.isHidden=!0,a=this._extendColumn(c,a)},_extendColumn:function(a,b){var c;return ne.util.isUndefined(a)||ne.util.isUndefined(a.columnName)||(c=this._indexOfColumnName(a.columnName,b),-1===c?b=_.union([a],b):b[c]=$.extend(b[c],a)),b},at:function(a,b){var c=b?this.getVisibleColumnModelList():this.get("columnModelList");return c[a]},indexOfColumnName:function(a,b){b=void 0===b?!0:b;var c=b?this.getVisibleColumnModelList():this.get("columnModelList");return this._indexOfColumnName(a,c)},_indexOfColumnName:function(a,b){for(var c=0,d=b.length;d>c;c++)if(b[c].columnName===a)return c;return-1},isLside:function(a){var b=this.indexOfColumnName(a,!0);return 0>b?!1:this.get("columnFixIndex")>b},getVisibleColumnModelList:function(a){a=a?a.toUpperCase():void 0;var b=[],c=this.get("columnFixIndex");return b="L"===a?this.get("visibleList").slice(0,c):"R"===a?this.get("visibleList").slice(c):this.get("visibleList")},getColumnModel:function(a){return this.get("columnModelMap")[a]},isTextType:function(a){var b=["normal","text","text-convertible"];return-1!==$.inArray(this.getEditType(a),b)},getEditType:function(a){var b=this.getColumnModel(a),c="normal";return"_button"===a||"_number"===a?c=a:b&&b.editOption&&b.editOption.type&&(c=b.editOption.type),c},_getVisibleList:function(a){return _.filter(a,function(a){return!a.isHidden})},_getRelationListMap:function(a){var b,c={};return ne.util.forEachArray(a,function(a){b=a.columnName,a.relationList&&(c[b]=a.relationList)}),c},_setColumnModelList:function(a,b){a=$.extend(!0,[],a),a=this._initializeNumberColumn(this._initializeButtonColumn(a));var c=this._getVisibleList(a);this.set({columnModelList:a,columnModelMap:_.indexBy(a,"columnName"),relationListMap:this._getRelationListMap(a),columnFixIndex:b,visibleList:c},{silent:!0}),this.trigger("columnModelChange")},_onChange:function(a){var b=a.changed,c=b.columnModelList||this.get("columnModelList"),d=b.columnFixIndex?b.columnFixIndex:this.get("columnFixIndex");this._setColumnModelList(c,d)}}),Data.Row=Model.Base.extend({idAttribute:"rowKey",defaults:{_extraData:{rowState:null}},initialize:function(){Model.Base.prototype.initialize.apply(this,arguments)},getRowState:function(){var a=this.get("_extraData"),b=a&&a.rowState,c=!1,d=!1,e=!1;if(b)switch(b){case"DISABLED":d=!0;break;case"DISABLED_CHECK":c=!0;break;case"CHECKED":e=!0}return c=d?d:c,{isDisabled:d,isDisabledCheck:c,isChecked:e}},getClassNameList:function(a){var b=[],c=this.get("_extraData"),d=c.className,e=d&&d.row||[],f=d&&a&&d.column&&d.column[a]||[];return b=_.union(b,e,f)},getCellState:function(a){var b,c,d=["_number","normal"],e=this.grid.columnModel,f=!1,g=!0,h=e.getEditType(a);return c=this.getRelationResult(["isDisabled","isEditable"])[a],b=this.getRowState(),f="_button"===a?b.isDisabledCheck:b.isDisabled,f=f||!(!c||!c.isDisabled),g=-1!==$.inArray(h,d)?!1:!(c&&c.isEditable===!1),{isEditable:g,isDisabled:f}},isEditable:function(a){var b,c,d=["_number","normal"];return b=this.grid.columnModel.getEditType(a),-1!==$.inArray(b,d)?!1:(c=this.getCellState(a),c.isEditable)},isDisabled:function(a){var b;return b=this.getCellState(a),b.isDisabled},getRowSpanData:function(a){var b=this.get("_extraData"),c={count:0,isMainRow:!0,mainRowKey:this.get("rowKey")};return this.collection.isRowSpanEnable()?a?(b=this.get("_extraData"),b&&b.rowSpanData&&b.rowSpanData[a]||c):b.rowSpanData:a?c:null},getHTMLEncodedString:function(a){var b=this.grid.columnModel.getColumnModel(a),c=this.grid.columnModel.isTextType(a),d=this.get(a),e=b.notUseHtmlEntity;return!e&&c&&ne.util.hasEncodableString(d)&&(d=ne.util.encodeHTMLEntity(d)),d},_getListTypeVisibleText:function(a){var b=this.get(a),c=this.grid.columnModel.getColumnModel(a);if(c&&c.editOption&&c.editOption.list){var d,e,f=this.getRelationResult(["optionListChange"])[a],g=f&&f.optionList?f.optionList:c.editOption.list;return d=typeof g[0].value,e=b.toString().split(","),d!==typeof e[0]&&(e=_.map(e,function(a){return Util.convertValueType(a,d)})),_.each(e,function(a,b){var c=_.findWhere(g,{value:a});e[b]=c&&c.text||""},this),e.join(",")}},getVisibleText:function(a){var b,c,d=this.grid.columnModel,e=this.get(a),f={select:!0,radio:!0,checkbox:!0};if(d)if(b=d.getEditType(a),c=d.getColumnModel(a),f[b]){if(!(c.editOption&&c.editOption.list&&c.editOption.list[0].value))throw this.error('Check "'+a+"\"'s editOption.list property out in your ColumnModel.");e=this._getListTypeVisibleText(a)}else _.isFunction(c.formatter)&&(e=Util.stripTags(c.formatter(this.getHTMLEncodedString(a),this.toJSON(),c)));return e=ne.util.isUndefined(e)?e:e.toString()},getRelationResult:function(a){a=a&&a.length?a:["optionListChange","isDisabled","isEditable"];var b,c,d,e,f=(this.get("rowKey"),this.toJSON()),g=this.grid.columnModel.get("relationListMap"),h={},i=this.getRowState();return _.each(g,function(g,j){e=f[j],_.each(g,function(g){d=g.columnList,_.each(a,function(a){if((!i.isDisabled||"isDisabled"!==a)&&(b=g[a],"function"==typeof b)){switch(c="",a){case"optionListChange":c="optionList";
break;case"isDisabled":c="isDisabled";break;case"isEditable":c="isEditable"}c&&_.each(d,function(a){h[a]=h[a]||{},h[a][c]=b(e,f)},this)}},this)},this)},this),h}}),Data.RowList=Collection.Base.extend({model:Data.Row,initialize:function(a,b){Collection.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({sortKey:"rowKey",originalRowList:[],originalRowMap:{},startIndex:b.startIndex||1,privateProperties:["_button","_number","_extraData"]}),this.on("change",this._onChange,this)},parse:function(a){return a=a&&a.contents||a,this.setOriginalRowList(a)},_formatData:function(a){{var b=a;this.grid.columnModel.get("keyColumnName")}return _.each(b,function(a,c){b[c]=this._baseFormat(b[c],c),this.isRowSpanEnable()&&this._setExtraRowSpanData(b,c)},this),b},_baseFormat:function(a,b){var c={rowSpan:null,rowSpanData:null,rowState:null},d=this.grid.columnModel.get("keyColumnName"),e=null===d?b:a[d];return a._extraData=$.extend(c,a._extraData),a._button="CHECKED"===a._extraData.rowState,a.rowKey=e,a},_setExtraRowSpanData:function(a,b){function c(a,b){var c=a._extraData;return!(!c.rowSpanData||!c.rowSpanData[b])}function d(a,b,c){var d=a._extraData;return d.rowSpanData=d&&d.rowSpanData||{},d.rowSpanData[b]=c,d}var e,f,g,h=a[b],i=h&&h._extraData&&h._extraData.rowSpan,j=h&&h.rowKey;return i&&_.each(i,function(i,k){if(!c(h,k))for(d(h,k,{count:i,isMainRow:!0,mainRowKey:j}),e=-1,g=b+1;b+i>g;g++)f=a[g],f[k]=h[k],f._extraData=f._extraData||{},d(f,k,{count:e--,isMainRow:!1,mainRowKey:j})}),a},setOriginalRowList:function(a){return this.originalRowList=a?this._formatData(a):this.toJSON(),this.originalRowMap=_.indexBy(this.originalRowList,"rowKey"),this.originalRowList},getOriginalRowList:function(a){return a=void 0===a?!0:a,a?_.clone(this.originalRowList):this.originalRowList},getOriginalRow:function(a){return _.clone(this.originalRowMap[a])},getOriginal:function(a,b){return _.clone(this.originalRowMap[a][b])},getMainRowKey:function(a,b){var c,d=this.get(a);return this.isRowSpanEnable()&&(c=d&&d.getRowSpanData(b),a=c?c.mainRowKey:a),a},indexOfRowKey:function(a){return this.indexOf(this.get(a))},_isPrivateProperty:function(a){return-1!==$.inArray(a,this.privateProperties)},isRowSpanEnable:function(){return!this.isSortedByField()},isSortedByField:function(){return"rowKey"!==this.sortKey},sortByField:function(a){this.sortKey=a,this.sort()},getRowList:function(a,b){var c,d;return a?(d=this.where({_button:!0}),c=[],_.each(d,function(a){c.push(a.attributes)},this)):c=this.toJSON(),b?c:this._removePrivateProp(c)},_onChange:function(a){var b;_.each(a.changed,function(c,d){if(!this._isPrivateProperty(d)){if(b=this.grid.columnModel.getColumnModel(d),!b)return;if(!this._executeChangeBeforeCallback(a,d))return;this._syncRowSpannedData(a,d,c),this._executeChangeAfterCallback(a,d),a.getRowState().isDisabledCheck||a.set("_button",!0)}},this)},_syncRowSpannedData:function(a,b,c){var d,e,f;if(this.isRowSpanEnable())if(e=a.getRowSpanData(b),e.isMainRow)for(d=this.indexOfRowKey(a.get("rowKey")),f=0;f<e.count-1;f++)this.at(f+1+d).set(b,c);else this.get(e.mainRowKey).set(b,c)},_createChangeCallbackEvent:function(a,b){return{rowKey:a.get("rowKey"),columnName:b,value:a.get(b)}},_executeChangeBeforeCallback:function(a,b){var c,d,e=this.grid.columnModel.getColumnModel(b);return e.editOption&&e.editOption.changeBeforeCallback&&(c=this._createChangeCallbackEvent(a,b),e.editOption.changeBeforeCallback(c)===!1)?(d={},d[b]=a.previous(b),a.set(d),a.trigger("restore",{changed:d}),!1):!0},_executeChangeAfterCallback:function(a,b){var c,d=this.grid.columnModel.getColumnModel(b);return d.editOption&&d.editOption.changeAfterCallback?(c=this._createChangeCallbackEvent(a,b),!!d.editOption.changeAfterCallback(c)):!0},comparator:function(a){return this.isSortedByField()?+a.get(this.sortKey):void 0},setExtraData:function(a,b,c){var d,e=this.get(a),f={};return e?(d=$.extend(!0,{},e.get("_extraData")),d=$.extend(!0,d,b),f._extraData=d,e.set(f,{silent:c}),!0):!1},setRowState:function(a,b,c){this.setExtraData(a,{rowState:b},c)},_removePrivateProp:function(a){var b,c=[];return _.each(a,function(a){b={},_.each(a,function(a,c){this._isPrivateProperty(c)||(b[c]=a)},this),c.push(b)},this),c},removeRow:function(a,b){var c=this.get(a);c&&(this.remove(c),b&&this.setOriginalRowList())},_createDummyRow:function(){var a=this.grid.columnModel.get("columnModelList"),b={};return _.each(a,function(a){b[a.columnName]=""},this),b},append:function(a,b){b=void 0!==b?b:this.length,a=a||this._createDummyRow();var c,d=[],e=this.grid.columnModel.get("keyColumnName"),f=this.length;a instanceof Array||(a=[a]),c=this._formatData(a),_.each(c,function(a,b){a.rowKey=e?a[e]:f+b,a._button=!0,d.push(new Data.Row(a,{collection:this}))},this),this.add(d,{at:b,merge:!0})},prepend:function(a){this.append(a,0)},getModifiedRowList:function(a){var b,c=a&&a.isRaw,d=a&&a.isOnlyChecked,e=a&&a.isOnlyRowKeyList,f=a&&a.filteringColumnList||[],g={},h=c?this.originalRowList:this._removePrivateProp(this.originalRowList),i=c?this.toJSON():this._removePrivateProp(this.toJSON()),j={createList:[],updateList:[],deleteList:[]};return _.each(f,function(a){g[a]=!0}),h=_.indexBy(h,"rowKey"),i=_.indexBy(i,"rowKey"),_.each(i,function(a,c){var f,i=h[c];b=e?a.rowKey:a,(!d||d&&this.get(c).get("_button"))&&(i?_.each(a,function(a,c){g[c]||(f="object"==typeof a?$.toJSON(a)!==$.toJSON(i[c]):a!==i[c],f&&j.updateList.push(b))},this):j.createList.push(b))},this),_.each(h,function(a,c){b=e?a.rowKey:a,i[c]||j.deleteList.push(b)},this),j}}),Model.Renderer=Model.Base.extend({defaults:{top:0,scrollTop:0,scrollLeft:0,maxScrollLeft:0,startIndex:0,endIndex:0,startNumber:1,lside:null,rside:null},initialize:function(){Model.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({timeoutIdForRowListChange:0,timeoutIdForRefresh:0,isColumnModelChanged:!1});var a=new Model.RowList([],{grid:this.grid}),b=new Model.RowList([],{grid:this.grid});this.set({lside:a,rside:b}),this.listenTo(this.grid.columnModel,"all",this._onColumnModelChange,this).listenTo(this.grid.dataModel,"add remove sort reset",this._onRowListChange,this).listenTo(a,"valueChange",this._onValueChange,this).listenTo(b,"valueChange",this._onValueChange,this)},_onValueChange:function(a){this.executeRelation(a)},initializeVariables:function(){this.set({top:0,scrollTop:0,$scrollTarget:null,scrollLeft:0,startIndex:0,endIndex:0,startNumber:1})},getCollection:function(a){a=a?a.toUpperCase():void 0;var b;switch(a){case"L":b=this.get("lside");break;case"R":b=this.get("rside");break;default:b=this.get("rside")}return b},_onColumnModelChange:function(){this.set({scrollTop:0,top:0,startIndex:0,endIndex:0}),this.isColumnModelChanged=!0,clearTimeout(this.timeoutIdForRefresh),this.timeoutIdForRefresh=setTimeout($.proxy(this.refresh,this),0)},_onRowListChange:function(){clearTimeout(this.timeoutIdForRefresh),this.timeoutIdForRefresh=setTimeout($.proxy(this.refresh,this),0)},_setRenderingRange:function(){this.set({startIndex:0,endIndex:this.grid.dataModel.length-1})},refresh:function(){this._setRenderingRange(this.get("scrollTop"));var a,b,c,d,e=this.grid.columnModel.get("columnFixIndex"),f=this.grid.columnModel.get("visibleList"),g=_.pluck(f,"columnName"),h=g.slice(0,e),i=g.slice(e),j=[],k=[],l=[],m=[],n=this.get("startIndex"),o=this.get("endIndex"),p=this.get("startNumber")+n;for(b=n;o+1>b;b++)c=this.grid.dataModel.at(b),d=c.get("rowKey"),l={_extraData:c.get("_extraData"),rowKey:d},m={_extraData:c.get("_extraData"),rowKey:d},_.each(h,function(a){l[a]="_number"==a?p++:c.get(a)}),_.each(i,function(a){m[a]="_number"==a?p++:c.get(a)}),j.push(l),k.push(m);for(this.get("lside").clear().reset(j,{parse:!0}),this.get("rside").clear().reset(k,{parse:!0}),b=n,a=k.length+n;a>b;b++)this.executeRelation(b);this.isColumnModelChanged===!0?(this.trigger("columnModelChanged",this.get("top")),this.isColumnModelChanged=!1):this.trigger("rowListChanged",this.get("top")),this.trigger("refresh",this.get("top"))},_getCollectionByColumnName:function(a){var b=this.get("lside"),c=this.get("rside");return b.at(0)&&b.at(0).get(a)?b:c},getCellData:function(a,b){var c=this._getCollectionByColumnName(b),d=c.get(a);return d?d.get(b):void 0},executeRelation:function(a){var b,c,d=this.grid.dataModel.at(a),e=a-this.get("startIndex");c=d.getRelationResult(),_.each(c,function(a,c){b=this._getCollectionByColumnName(c).at(e),b&&this._getCollectionByColumnName(c).at(e).setCell(c,a)},this)}}),Model.Dimension=Model.Base.extend({models:null,columnModel:null,defaults:{offsetLeft:0,offsetTop:0,width:0,headerHeight:0,bodyHeight:0,toolbarHeight:0,rowHeight:0,rsideWidth:0,lsideWidth:0,columnWidthList:[],minimumColumnWidth:0,displayRowCount:1,scrollBarSize:17,scrollX:!0},initialize:function(){Model.Base.prototype.initialize.apply(this,arguments),this.columnModel=this.grid.columnModel,this.listenTo(this.columnModel,"columnModelChange",this._setColumnWidthVariables),this.on("change:width",this._onWidthChange,this),this._setColumnWidthVariables(),this._setBodyHeight()},_calculateColumnWidthList:function(a){var b,c,d,e=this.columnModel.get("columnFixIndex"),f=this.get("width"),g=[],h=0,i=0,j=0;return b=f-a.length-1,e>0&&(b-=1),_.each(a,function(a){a>0?(h=Math.max(this.get("minimumColumnWidth"),a),g.push(h),i+=h):(g.push(-1),j++)},this),c=b-i,b>i&&0===j&&(g[g.length-1]+=c),b>i?(c=b-i,d=Math.max(this.get("minimumColumnWidth"),Math.floor(c/j))):d=this.get("minimumColumnWidth"),_.each(g,function(a,b){-1===a&&(g[b]=d)},this),g},_getOriginalWidthList:function(){for(var a=this.columnModel.get("visibleList"),b=[],c=0,d=a.length;d>c;c++)b.push(a[c].width?a[c].width:-1);return this._calculateColumnWidthList(b)},getFrameWidth:function(a){var b=this.grid.columnModel.get("columnFixIndex"),c=this.getColumnWidthList(a),d=this._getFrameWidth(c);return ne.util.isUndefined(a)&&b>0&&++d,d},_getFrameWidth:function(a){return a.length?Util.sum(a)+a.length+1:0},_setColumnWidthVariables:function(a){a=a||this._getOriginalWidthList();var b,c,d=this.get("width"),e=this.columnModel.get("columnFixIndex"),f=this._getMaxLeftSideWidth(),g=a.slice(0,e),h=a.slice(e);c=this._getFrameWidth(g),c>f&&(g=this._adjustLeftSideWidthList(g,f),c=this._getFrameWidth(g),a=g.concat(h)),b=d-c,this.set({rsideWidth:b,lsideWidth:c,columnWidthList:a}),this.trigger("columnWidthChanged")},_getMinLeftSideWidth:function(){var a,b=this.get("minimumColumnWidth"),c=this.columnModel.get("columnFixIndex");return a=c?c*(b+1)+1:0},_getMaxLeftSideWidth:function(){var a=Math.ceil(.9*this.get("width"));return a=Math.max(a,this._getMinLeftSideWidth())},getCellPosition:function(a,b){var c,d,e,f,g,h=0,i=0,j=this.grid.dataModel,k=(this.get("offsetLeft"),this.get("offsetTop"),this.get("rowHeight")),l=j.get(a).getRowSpanData(b),m=this.get("columnWidthList"),n=this.grid.columnModel.get("columnFixIndex"),o=this.grid.columnModel.indexOfColumnName(b,!0);for(l.isMainRow||(a=l.mainRowKey,l=j.get(a).getRowSpanData(b)),g=l.count||1,f=j.indexOfRowKey(a),c=Util.getHeight(f,k),e=c+Util.getHeight(g,k)-1,o>=n&&(i=n);o>i;i++)h+=m[i]+1;return d=h+m[i]+1,{top:c,left:h,right:d,bottom:e}},_adjustLeftSideWidthList:function(a,b){var c,d=a.length-1,e=this.get("minimumColumnWidth"),f=this._getFrameWidth(a),g=f-b;if(g>0)for(;d>=0&&g>0;)c=Math.max(e,a[d]-g),g-=a[d]-c,a[d]=c,d--;else 0>g&&(a[d]+=Math.abs(g));return a},_setBodyHeight:function(){var a=Util.getHeight(this.get("displayRowCount"),this.get("rowHeight"));this.get("scrollX")&&(a+=this.get("scrollBarSize")),this.set("bodyHeight",a)},getDisplayRowCount:function(){return Util.getDisplayRowCount(this.get("bodyHeight")-this.get("toolbarHeight"),this.get("rowHeight"))},getScrollXHeight:function(){return+this.get("scrollX")*this.get("scrollBarSize")},_onWidthChange:function(){var a=this.get("columnWidthList");this._setColumnWidthVariables(this._calculateColumnWidthList(a))},setColumnWidth:function(a,b){b=Math.max(b,this.get("minimumColumnWidth"));var c,d=this.get("columnWidthList");ne.util.isUndefined(d[a])||(d[a]=b,c=this._calculateColumnWidthList(d),this._setColumnWidthVariables(c))},getColumnWidthList:function(a){a=a?a.toUpperCase():void 0;var b=this.columnModel.get("columnFixIndex"),c=[];switch(a){case"L":c=this.get("columnWidthList").slice(0,b);break;case"R":c=this.get("columnWidthList").slice(b);break;default:c=this.get("columnWidthList")}return c}}),Model.Focus=Model.Base.extend({defaults:{rowKey:null,columnName:"",prevRowKey:null,prevColumnName:"",scrollX:!0,scrollY:!0,scrollBarSize:17},initialize:function(){Model.Base.prototype.initialize.apply(this,arguments)},_savePrevious:function(){null!==this.get("rowKey")&&this.set("prevRowKey",this.get("rowKey")),this.get("columnName")&&this.set("prevColumnName",this.get("columnName"))},_clearPrevious:function(){this.set({prevRowKey:null,prevColumnName:""})},select:function(a){return this.unselect().set("rowKey",a),this.trigger("select",a),this},unselect:function(){return this.blur(),this.trigger("unselect",this.get("rowKey")),this.set({rowKey:null}),this},focus:function(a,b,c){var d;return a=void 0===a?this.get("rowKey"):a,b=void 0===b?this.get("columnName"):b,this._savePrevious(),this.blur(),a!==this.get("rowKey")&&this.select(a),b&&b!==this.get("columnName")&&this.set("columnName",b),this.trigger("focus",a,b),c&&(d=this._getScrollPosition(),!ne.util.isEmpty(d)&&this.grid.renderModel.set(d)),this},_getScrollPosition:function(){var a=this.which(),b=this.grid.dimensionModel,c=this.grid.renderModel,d=c.get("scrollTop"),e=c.get("scrollLeft"),f=b.get("bodyHeight"),g=(b.get("lsideWidth"),b.get("rsideWidth")),h=b.getCellPosition(a.rowKey,a.columnName),i=e,j=e+g,k=+this.get("scrollX")*this.get("scrollBarSize"),l=+this.get("scrollY")*this.get("scrollBarSize"),m={};return h.top<d?m.scrollTop=h.top:h.bottom>f+d-k&&(m.scrollTop=h.bottom-f+k),this.grid.columnModel.isLside(a.columnName)||(h.left<i?m.scrollLeft=h.left:h.right>j&&(m.scrollLeft=h.right-g+l+1)),m},blur:function(){return this.trigger("blur",this.get("rowKey"),this.get("columnName")),null!==this.get("rowKey")&&this.set("columnName",""),this},which:function(){return{rowKey:this.get("rowKey"),columnName:this.get("columnName")}},indexOf:function(a){var b=this.get(a?"prevRowKey":"rowKey"),c=this.get(a?"prevColumnName":"columnName");return{rowIdx:this.grid.dataModel.indexOfRowKey(b),columnIdx:this.grid.columnModel.indexOfColumnName(c,!0)}},has:function(){return!(ne.util.isUndefined(this.get("rowKey"))||null===this.get("rowKey"))&&this.get("columnName")},_findRowKey:function(a){var b,c,d=this.grid.dataModel;return this.has()?(b=Math.max(Math.min(d.indexOfRowKey(this.get("rowKey"))+a,this.grid.dataModel.length-1),0),c=d.at(b),c&&c.get("rowKey")):void 0},_findColumnName:function(a){var b,c=this.grid.columnModel,d=c.getVisibleColumnModelList(),e=c.indexOfColumnName(this.get("columnName"),!0);return this.has()?(b=Math.max(Math.min(e+a,d.length-1),0),d[b]&&d[b].columnName):void 0},_getRowSpanData:function(a,b){return this.grid.dataModel.get(a).getRowSpanData(b)},nextRowIndex:function(a){var b=this.nextRowKey(a);return this.grid.dataModel.indexOfRowKey(b)},prevRowIndex:function(a){var b=this.prevRowKey(a);return this.grid.dataModel.indexOfRowKey(b)},nextColumnIndex:function(){var a=this.nextColumnName();return this.grid.columnModel.indexOfColumnName(a,!0)},prevColumnIndex:function(){var a=this.prevColumnName();return this.grid.columnModel.indexOfColumnName(a,!0)},nextRowKey:function(a){var b,c,d=this.which(),e=d.rowKey;return a="number"==typeof a?a:1,a>1?(e=this._findRowKey(a),c=this._getRowSpanData(e,d.columnName),c.isMainRow||(e=this._findRowKey(c.count+a))):(c=this._getRowSpanData(e,d.columnName),c.isMainRow&&c.count>0?e=this._findRowKey(c.count):c.isMainRow?e=this._findRowKey(1):(b=c.count,c=this._getRowSpanData(c.mainRowKey,d.columnName),e=this._findRowKey(c.count+b))),e},prevRowKey:function(a){var b,c=this.which(),d=c.rowKey;return a="number"==typeof a?a:1,a*=-1,-1>a?(d=this._findRowKey(a),b=this._getRowSpanData(d,c.columnName),b.isMainRow||(d=this._findRowKey(b.count+a))):(b=this._getRowSpanData(d,c.columnName),d=this._findRowKey(b.isMainRow?-1:b.count-1)),d},nextColumnName:function(){return this._findColumnName(1)},prevColumnName:function(){return this._findColumnName(-1)},firstRowKey:function(){return this.grid.dataModel.at(0).get("rowKey")},lastRowKey:function(){return this.grid.dataModel.at(this.grid.dataModel.length-1).get("rowKey")},firstColumnName:function(){var a=this.grid.columnModel.getVisibleColumnModelList();return a[0].columnName},lastColumnName:function(){var a=this.grid.columnModel.getVisibleColumnModelList(),b=a.length-1;return a[b].columnName}}),Model.Renderer.Smart=Model.Renderer.extend({initialize:function(){Model.Renderer.prototype.initialize.apply(this,arguments),this.on("change:scrollTop",this._onChange,this),this.listenTo(this.grid.dimensionModel,"change:bodyHeight",this._onChange,this),this.setOwnProperties({hiddenRowCount:10,criticalPoint:3})},_onChange:function(){this._isRenderable(this.get("scrollTop"))===!0&&this.refresh()},_setRenderingRange:function(a){var b,c,d,e,f,g=this.grid.dimensionModel,h=this.grid.dataModel,i=g.get("rowHeight"),j=(g.get("bodyHeight"),g.getDisplayRowCount()),k=Math.max(0,Math.ceil(a/(i+1))-this.hiddenRowCount),l=Math.min(h.length-1,Math.floor(k+this.hiddenRowCount+j+this.hiddenRowCount));h.isRowSpanEnable()&&(e=[],f=[],c=h.at(k),d=h.at(l),c&&d&&(_.each(c.get("_extraData").rowSpanData,function(a){a.isMainRow||e.push(a.count)},this),_.each(d.get("_extraData").rowSpanData,function(a){a.count>0&&f.push(a.count)},this),e.length>0&&(k+=Math.min.apply(Math,e)),f.length>0&&(l+=Math.max.apply(Math,f)))),b=0===k?0:Util.getHeight(k,i)-1,this.set({top:b,startIndex:k,endIndex:l})},_isRenderable:function(a){var b=this.grid,c=b.dimensionModel,d=b.dataModel,e=c.get("rowHeight"),f=c.get("bodyHeight"),g=d.length,h=Math.max(0,Math.ceil(a/(e+1))),i=Math.min(d.length-1,Math.floor((a+f)/(e+1))),j=this.get("startIndex"),k=this.get("endIndex");return 0!==j&&j+this.criticalPoint>h?!0:k!==g-1&&k-this.criticalPoint<i?!0:!1}}),Model.Row=Model.Base.extend({idAttribute:"rowKey",defaults:{},initialize:function(a){Model.Base.prototype.initialize.apply(this,arguments);var b=a&&a.rowKey;this.setOwnProperties({dataModel:this.grid.dataModel,columnModel:this.grid.columnModel,renderModel:this.grid.renderModel}),this.dataModel.get(b)&&(this.listenTo(this.dataModel.get(b),"change",this._onDataModelChange,this),this.listenTo(this.dataModel.get(b),"restore",this._onDataModelChange,this))},_onDataModelChange:function(a){_.each(a.changed,function(a,b){"_extraData"===b?this._setRowExtraData():this.setCell(b,{value:a})},this)},_setRowExtraData:function(){if(!ne.util.isUndefined(this.collection)){var a,b=this.dataModel,c=this.columnModel.getVisibleColumnModelList(),d=this.dataModel.get(this.get("rowKey")),e=d.getRowState();_.each(c,function(c){var f,g,h=c.columnName,i=this.get(h),j=this;ne.util.isUndefined(i)||(f=d.isEditable(h),g="_button"===h?e.isDisabledCheck:e.isDisabled,b.isRowSpanEnable()&&(i.isMainRow||(j=this.collection.get(i.mainRowKey))),j&&(a={isDisabled:g,isEditable:f,className:d.getClassNameList(h).join(" ")},j.setCell(h,a)))},this)}},parse:function(a){return this._formatData(a)},_formatData:function(a){var b=this.grid||this.collection.grid,c=b.dataModel,d=a.rowKey;return _.each(a,function(b,e){var f,g=c.get(d),h=g.getRowState(),i=h.isDisabled,j=g.isEditable(e),k={mainRowKey:d,count:0,isMainRow:!0};"rowKey"!==e&&"_extraData"!==e&&(f=c.isRowSpanEnable()?a._extraData&&a._extraData.rowSpanData&&a._extraData.rowSpanData[e]||k:k,i="_button"===e?h.isDisabledCheck:i,a[e]={rowKey:d,columnName:e,value:b,rowSpan:f.count,isMainRow:f.isMainRow,mainRowKey:f.mainRowKey,isEditable:j,isDisabled:i,optionList:[],className:g.getClassNameList(e).join(" "),changed:[]})},this),a},setCell:function(a,b){if(this.get(a)){var c,d=_.clone(this.get(a)),e=!1,f=[],g=this.get("rowKey");_.each(b,function(a,b){Util.isEqual(d[b],a)||(e="value"===b?!0:e,d[b]=a,f.push(b))},this),f.length&&(d.changed=f,this.set(a,d),e&&(c=this.dataModel.indexOfRowKey(g),this.trigger("valueChange",c)))}}}),Model.RowList=Collection.Base.extend({model:Model.Row,initialize:function(){Collection.Base.prototype.initialize.apply(this,arguments)}}),View.Layer.Base=View.Base.extend({initialize:function(){View.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({text:"기본 텍스트"}),this.listenTo(this.grid.dimensionModel,"change",this._resize,this)},template:_.template('<div>    <%=text%>    <div class="loading_img"></div></div>'),render:function(a){return this.$el.html(this.template({text:a||this.text})).css("display","none"),this},show:function(a){this.render(a).$el.css("display","block").css("zIndex",1),this._resize()},hide:function(){this.$el.css("display","none")},_resize:function(){if("block"===this.$el.css("display")){var a=this.grid.dimensionModel.get("headerHeight"),b=this.grid.dimensionModel.get("bodyHeight");this.$el.css("marginTop",a+"px").css("height",b+"px")}}}),View.Layer.Empty=View.Layer.Base.extend({className:"no_row_layer",initialize:function(){View.Layer.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({text:"데이터가 존재하지 않습니다."})},template:_.template("<%=text%>")}),View.Layer.Loading=View.Layer.Base.extend({className:"loading_layer",initialize:function(){View.Layer.Base.prototype.initialize.apply(this,arguments),this.text="요청을 처리 중입니다."},template:_.template('<div>    <%=text%>    <div class="loading_img"></div></div>')}),View.Layer.Ready=View.Layer.Base.extend({className:"initializing_layer",initialize:function(){View.Layer.Base.prototype.initialize.apply(this,arguments),this.text="초기화 중 입니다."}}),View.Layout.Frame=View.Base.extend({tagName:"div",className:"lside_area",initialize:function(a){View.Base.prototype.initialize.apply(this,arguments),this.listenTo(this.grid.renderModel,"columnModelChanged",this.render,this),this.listenTo(this.grid.dimensionModel,"columnWidthChanged",this._onColumnWidthChanged,this),this.setOwnProperties({header:null,body:null,whichSide:a&&a.whichSide||"R"})},render:function(){var a,b;return this.destroyChildren(),this.beforeRender(),a=this.header=this.createView(View.Layout.Header,{grid:this.grid,whichSide:this.whichSide}),b=this.body=this.createView(View.Layout.Body,{grid:this.grid,whichSide:this.whichSide}),this.$el.append(a.render().el).append(b.render().el),this.afterRender(),this},_onColumnWidthChanged:function(){},beforeRender:function(){},afterRender:function(){}}),View.Layout.Body=View.Base.extend({tagName:"div",className:"data",template:_.template('<div class="table_container" style="top: 0px">    <table width="100%" border="0" cellspacing="1" cellpadding="0" bgcolor="#EFEFEF">        <colgroup><%=colGroup%></colgroup>        <tbody></tbody>    </table></div>'),events:{scroll:"_onScroll",mousedown:"_onMouseDown"},initialize:function(a){View.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:a&&a.whichSide||"R",isScrollSync:!1}),this.listenTo(this.grid.dimensionModel,"columnWidthChanged",this._onColumnWidthChanged,this).listenTo(this.grid.dimensionModel,"change:bodyHeight",this._onBodyHeightChange,this).listenTo(this.grid.renderModel,"change:scrollTop",this._onScrollTopChange,this).listenTo(this.grid.renderModel,"change:scrollLeft",this._onScrollLeftChange,this).listenTo(this.grid.renderModel,"refresh",this._setTopPosition,this)},_onBodyHeightChange:function(a,b){this.$el.css("height",b+"px")},_onColumnWidthChanged:function(){var a=this.grid.dimensionModel.getColumnWidthList(this.whichSide),b=this.$el.find("col");_.each(a,function(a,c){b.eq(c).css("width",a+"px")})},_onMouseDown:function(a){var b,c,d=this.grid,e=d.selection;a.shiftKey?(b=d.focusModel.indexOf(!0),e.hasSelection()||e.startSelection(b.rowIdx,b.columnIdx),e.attachMouseEvent(a.pageX,a.pageY),c=e.getIndexFromMousePosition(a.pageX,a.pageY),e.updateSelection(c.row,c.column),d.focusAt(c.row,c.column)):(e.endSelection(),e.attachMouseEvent(a.pageX,a.pageY))},_onScroll:function(a){var b={},c=this.grid.renderModel;b.scrollTop=a.target.scrollTop,"R"===this.whichSide&&(b.scrollLeft=a.target.scrollLeft),c.set(b)},_onScrollLeftChange:function(a,b){"R"===this.whichSide&&(this.el.scrollLeft=b)},_onScrollTopChange:function(a,b){this.el.scrollTop=b},_setTopPosition:function(a){this.$el.children(".table_container").css("top",a+"px")},render:function(){var a,b,c=this.grid,d=this.whichSide,e=c.renderModel.getCollection(d);return this.destroyChildren(),this.$el.css({height:c.dimensionModel.get("bodyHeight")}).html(this.template({colGroup:this._getColGroupMarkup()})),b=this.createView(View.RowList,{grid:c,collection:e,el:this.$el.find("tbody"),whichSide:d}),b.render(),a=this.addView(c.selection.createLayer(d)),this.$el.append(a.render().el),this},_getColGroupMarkup:function(){var a=this.grid,b=this.whichSide,c=a.columnModel,d=a.dimensionModel,e=d.getColumnWidthList(b),f=c.getVisibleColumnModelList(b),g="";return _.each(f,function(a,b){g+='<col columnname="'+a.columnName+'" style="width:'+e[b]+'px">'}),g}}),View.Layout.Frame.Lside=View.Layout.Frame.extend({className:"lside_area",initialize:function(){View.Layout.Frame.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:"L"})},_onColumnWidthChanged:function(){var a=this.grid.dimensionModel.get("lsideWidth");this.$el.css({width:a+"px"})},beforeRender:function(){var a=this.grid.dimensionModel.get("lsideWidth");this.$el.css({display:"block",width:a+"px"})}}),View.Layout.Frame.Rside=View.Layout.Frame.extend({className:"rside_area",initialize:function(){View.Layout.Frame.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:"R"})},_onColumnWidthChanged:function(){var a=this.grid.dimensionModel,b=a.get("lsideWidth"),c=a.get("rsideWidth");this.$el.css({width:c+"px",marginLeft:b+"px"})},beforeRender:function(){var a=this.grid.dimensionModel,b=a.get("lsideWidth"),c=a.get("rsideWidth");this.$el.css({display:"block",width:c+"px",marginLeft:b+"px"})},afterRender:function(){var a,b=$("<div></div>");b.css({height:this.grid.dimensionModel.get("headerHeight")-2}).addClass("space"),this.$el.append(b),this.grid.option("notUseSmartRendering")===!1&&(a=this.createView(View.Layout.Frame.Rside.VirtualScrollBar,{grid:this.grid}),this.$el.append(a.render().el))}}),View.Layout.Frame.Rside.VirtualScrollBar=View.Base.extend({tagName:"div",className:"virtual_scrollbar",initialize:function(){View.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({hasFocus:!1}),this.listenTo(this.grid.dataModel,"sort add remove reset",this._setHeight,this),this.listenTo(this.grid.dimensionModel,"change",this._onDimensionChange,this),this.listenTo(this.grid.renderModel,"change:scrollTop",this._onScrollTopChange,this),this.timeoutForScroll=0},template:_.template('<div class="content"></div>'),events:{scroll:"_onScroll",mousedown:"_onMouseDown"},_onMouseDown:function(){this.hasFocus=!0,$(document).on("mouseup",$.proxy(this._onMouseUp,this))},_onMouseUp:function(){this.hasFocus=!1,$(document).off("mouseup",$.proxy(this._onMouseUp,this))},_onScroll:function(a){clearTimeout(this.timeoutForScroll),this.hasFocus&&(this.timeoutForScroll=setTimeout($.proxy(function(){this.grid.renderModel.set("scrollTop",a.target.scrollTop)},this),0))},_onDimensionChange:function(a){(a.changed.headerHeight||a.changed.bodyHeight)&&this.render()},_onScrollTopChange:function(a,b){var c;this.el.scrollTop=b,c=this.el.scrollTop,c!==b&&this.grid.renderModel.set("scrollTop",c)},render:function(){var a=this.grid;return this.$el.css({height:a.dimensionModel.get("bodyHeight")-a.scrollBarSize,top:a.dimensionModel.get("headerHeight"),display:"block"}).html(this.template()),this._setHeight(),this},_setHeight:function(){var a=this.grid,b=a.dimensionModel.get("rowHeight"),c=a.dataModel.length,d=b*a.dataModel.length+(c+1);this.$el.find(".content").height(d)},destroy:function(){this._onMouseUp(),this.destroyChildren(),this.remove()}}),View.Layout.Header=View.Base.extend({tagName:"div",className:"header",viewList:[],whichSide:"R",events:{click:"_onClick"},initialize:function(a){View.Base.prototype.initialize.apply(this,arguments),this.whichSide=a.whichSide,this.viewList=[],this.setOwnProperties({timeoutForAllChecked:0}),this.listenTo(this.grid.renderModel,"change:scrollLeft",this._onScrollLeftChange,this).listenTo(this.grid.dimensionModel,"columnWidthChanged",this._onColumnWidthChanged,this).listenTo(this.grid.dataModel,"change:_button",this._onCheckCountChange,this)},template:_.template('    <table width="100%" border="0" cellspacing="1" cellpadding="0" bgcolor="#EFEFEF">        <colgroup><%=colGroup%></colgroup>        <tbody><%=tBody%></tbody>    </table>'),templateHeader:_.template('<th columnname="<%=columnName%>" height="<%=height%>" <%if(colspan > 0) {%>colspan=<%=colspan%> <%}%><%if(rowspan > 0) {%>rowspan=<%=rowspan%> <%}%>><%=title%></th>'),templateCol:_.template('<col columnname="<%=columnName%>" style="width:<%=width%>px">'),_getColGroupMarkup:function(){var a=this._getColumnData(),b=a.widthList,c=a.modelList,d=[];return _.each(b,function(a,b){d.push(this.templateCol({columnName:c[b].columnName,width:a}))},this),d.join("")},_onCheckCountChange:function(){"checkbox"===this.grid.option("selectType")&&(clearTimeout(this.timeoutForAllChecked),this.timeoutForAllChecked=setTimeout($.proxy(this._syncCheckState,this),10))},_getHeaderMainCheckbox:function(){return this.$el.find('th[columnname="_button"] input')},_syncCheckState:function(){if("checkbox"===this.grid.option("selectType")){var a,b=this._getHeaderMainCheckbox(),c=0;b.length&&(a=this.grid.dataModel.getRowList(!0).length,this.grid.dataModel.forEach(function(a){var b=a.getCellState("_button");!b.isDisabled&&b.isEditable&&c++},this),b.prop("checked",c===a))}},_onColumnWidthChanged:function(){var a=this._getColumnData(),b=a.widthList,c=this.$el.find("col");_.each(b,function(a,b){c.eq(b).css("width",a+"px")})},_onScrollLeftChange:function(a,b){"R"===this.whichSide&&(this.el.scrollLeft=b)},_onClick:function(a){var b,c=$(a.target);"_button"===c.closest("th").attr("columnname")&&c.is("input")&&(b=c.prop("checked"),b?this.grid.checkAll():this.grid.uncheckAll())},render:function(){this.destroyChildren();var a=this.createView(View.Layout.Header.ResizeHandler,{whichSide:this.whichSide,grid:this.grid});return this.$el.css({height:this.grid.dimensionModel.get("headerHeight")}).html(this.template({colGroup:this._getColGroupMarkup(),tBody:this._getTableBodyMarkup()})),this.$el.append(a.render().el),this},_getColumnData:function(){var a=this.grid.columnModel,b=this.grid.dimensionModel,c=b.getColumnWidthList(this.whichSide),d=a.getVisibleColumnModelList(this.whichSide);return{widthList:c,modelList:d}},_getTableBodyMarkup:function(){var a,b=this._getColumnHierarchyList(),c=this._getHierarchyMaxRowCount(b),d=this.grid.dimensionModel.get("headerHeight"),e=new Array(c),f=[],g=new Array(c),h=[],i=Util.getRowHeight(c,d)-1,j=1;return _.each(b,function(f,k){var l=b[k].length,m=0;_.each(f,function(b,f){var k=b.columnName;j=l-1==f&&c-l+1>1?c-l+1:1,a=i*j,f===l-1?a=d-m-2:m+=a+1,g[f]==k?(e[f].pop(),h[f]+=1):h[f]=1,g[f]=k,e[f]=e[f]||[],e[f].push(this.templateHeader({columnName:k,height:a,colspan:h[f],rowspan:j,title:b.title}))},this)},this),_.each(e,function(a){f.push("<tr>"+a.join("")+"</tr>")}),f.join("")},_getHierarchyMaxRowCount:function(a){var b=[0];return _.each(a,function(a){b.push(a.length)},this),Math.max.apply(Math,b)},_getColumnHierarchyList:function(){var a=this._getColumnData().modelList,b=[];return _.each(a,function(a){b.push(this._getColumnHierarchy(a).reverse())},this),b},_getColumnHierarchy:function(a,b){var c=this.grid.option("columnMerge");return b=b||[],a&&(b.push(a),c&&_.each(c,function(c){-1!==$.inArray(a.columnName,c.columnNameList)&&(b=this._getColumnHierarchy(c,b))},this)),b}}),View.Layout.Header.ResizeHandler=View.Base.extend({tagName:"div",className:"resize_handle_container",viewList:[],whichSide:"R",events:{"mousedown .resize_handle":"_onMouseDown"},initialize:function(a){View.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:a.whichSide,isResizing:!1,$target:null,differenceLeft:0,initialWidth:0,initialOffsetLeft:0,initialLeft:0}),this.listenTo(this.grid.dimensionModel,"columnWidthChanged",this._refreshHandlerPosition,this)
},template:_.template('<div columnindex="<%=columnIndex%>" columnname="<%=columnName%>" class="resize_handle<% if(isLast === true)  print(" resize_handle_last");%>" style="<%=height%>" title="마우스 드래그를 통해 컬럼의 넓이를 변경할 수 있고,더블클릭을 통해 넓이를 초기화할 수 있습니다."></div>'),_getColumnData:function(){var a=this.grid.columnModel,b=this.grid.dimensionModel,c=b.getColumnWidthList(this.whichSide),d=a.getVisibleColumnModelList(this.whichSide);return{widthList:c,modelList:d}},_getResizeHandlerMarkup:function(){var a=this._getColumnData(),b=a.modelList,c=[],d=this.grid.dimensionModel.get("headerHeight"),e=b.length;return _.each(b,function(a,b){c.push(this.template({columnIndex:b,columnName:a.columnName,isLast:b+1===e,height:d}))},this),c.join("")},render:function(){var a=this.grid.dimensionModel.get("headerHeight");return this.$el.empty(),this.$el.show().css({marginTop:-a+"px",height:a+"px"}).html(this._getResizeHandlerMarkup()),this._refreshHandlerPosition(),this},_refreshHandlerPosition:function(){for(var a=this._getColumnData(),b=a.widthList,c=this.$el.find(".resize_handle"),d=0,e=0,f=c.length;f>e;e++)d+=b[e]+1,c.eq(e).css("left",d-3+"px")},_isResizing:function(){return!!this.isResizing},_onMouseDown:function(a){this._startResizing(a)},_onMouseUp:function(){this._stopResizing()},_onMouseMove:function(a){if(this._isResizing()){a.preventDefault();var b=a.pageX-this.initialOffsetLeft,c=this._calculateWidth(a.pageX),d=parseInt(this.$target.attr("columnindex"),10);this.$target.css("left",b+"px"),this.grid.dimensionModel.setColumnWidth(this._getColumnIndex(d),c)}},_calculateWidth:function(a){var b=a-this.initialOffsetLeft-this.initialLeft;return this.initialWidth+b},_getColumnIndex:function(a){return"R"===this.whichSide?a+this.grid.columnModel.get("columnFixIndex"):a},_startResizing:function(a){var b=this._getColumnData(),c=b.widthList,d=$(a.target);this.isResizing=!0,this.$target=d,this.initialLeft=parseInt(d.css("left").replace("px",""),10),this.initialOffsetLeft=this.$el.offset().left,this.initialWidth=c[d.attr("columnindex")],this.grid.$el.bind("mousemove",$.proxy(this._onMouseMove,this)).bind("mouseup",$.proxy(this._onMouseUp,this)).css("cursor","col-resize")},_stopResizing:function(){this.isResizing=!1,this.$target=null,this.initialLeft=0,this.initialOffsetLeft=0,this.initialWidth=0,this.grid.$el.unbind("mousemove",$.proxy(this._onMouseMove,this)).unbind("mouseup",$.proxy(this._onMouseUp,this)).css("cursor","default")},destroy:function(){this._stopResizing(),this.destroyChildren(),this.remove()}}),View.Layout.Toolbar=View.Base.extend({tagName:"div",className:"toolbar",initialize:function(){View.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({controlPanel:null,resizeHandler:null,pagination:null})},render:function(){this.destroyChildren();var a,b,c,d=this.grid.option("toolbar");return this.$el.empty(),d&&d.hasControlPanel&&(b=this.createView(View.Layout.Toolbar.ControlPanel,{grid:this.grid}),this.$el.append(b.render().el).css("display","block")),d&&d.hasResizeHandler&&(a=this.createView(View.Layout.Toolbar.ResizeHandler,{grid:this.grid}),this.$el.append(a.render().el).css("display","block")),d&&d.hasPagination&&(c=this.createView(View.Layout.Toolbar.Pagination,{grid:this.grid}),this.$el.append(c.render().el).css("display","block")),this.setOwnProperties({controlPanel:b,resizeHandler:a,pagination:c}),this}}),View.Layout.Toolbar.ControlPanel=View.Base.extend({tagName:"div",className:"btn_setup",template:_.template('<a href="#" class="excel_download_button btn_text excel_all" style="display: inline-block;"><span><em class="f_bold p_color5">전체엑셀다운로드</em></span></a><a href="#" class="excel_download_button btn_text excel_grid" style="display: inline-block;"><span><em class="excel">엑셀다운로드</em></span></a><a href="#" class="grid_configurator_button btn_text" style="display: none;"><span><em class="grid">그리드설정</em></span></a>'),initialize:function(){View.Base.prototype.initialize.apply(this,arguments)},render:function(){return this.destroyChildren(),this.$el.html(this.template()),this}}),View.Layout.Toolbar.ResizeHandler=View.Base.extend({tagName:"div",className:"height_resize_bar",events:{mousedown:"_onMouseDown"},template:_.template('<a href="#" class="height_resize_handle">높이 조절</a>'),initialize:function(){View.Base.prototype.initialize.apply(this,arguments)},_attachMouseEvent:function(){$(document).on("mousemove",$.proxy(this._onMouseMove,this)),$(document).on("mouseup",$.proxy(this._onMouseUp,this)),$(document).on("selectstart",$.proxy(this._onSelectStart,this))},_detachMouseEvent:function(){$(document).off("mousemove",$.proxy(this._onMouseMove,this)),$(document).off("mouseup",$.proxy(this._onMouseUp,this)),$(document).off("selectstart",$.proxy(this._onSelectStart,this))},_onMouseDown:function(a){a.preventDefault(),$(document.body).css("cursor","row-resize"),this.grid.updateLayoutData(),this._attachMouseEvent()},_onMouseMove:function(a){var b=this.grid.dimensionModel,c=b.get("offsetTop"),d=b.get("headerHeight"),e=b.get("rowHeight"),f=b.get("toolbarHeight"),g=a.pageY-c-d-f;g=Math.max(g,e+b.getScrollXHeight()),b.set({bodyHeight:g})},_onMouseUp:function(){$(document.body).css("cursor","default"),this._detachMouseEvent()},_onSelectStart:function(a){return a.preventDefault(),!1},render:function(){return this.destroyChildren(),this.$el.html(this.template()),this},destroy:function(){this._onMouseUp(),this.destroyChildren(),this.remove()}}),View.Layout.Toolbar.Pagination=View.Base.extend({tagName:"div",className:"pagination",template:_.template('<a href="#" class="pre_end">맨앞</a><a href="#" class="pre">이전</a> <a href="#" class="next">다음</a><a href="#" class="next_end">맨뒤</a>'),initialize:function(){View.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({instance:null})},render:function(){return this.destroyChildren(),this.$el.empty().html(this.template()),this._setPaginationInstance(),this},_setPaginationInstance:function(){var a=ne&&ne.Component&&ne.Component.Pagination,b=this.instance;!b&&a&&(b=new a({itemCount:1,itemPerPage:1},this.$el)),this.setOwnProperties({instance:b})}}),View.Painter.Row=View.Base.Painter.extend({eventHandler:{mousedown:"_onMouseDown"},baseTemplate:_.template('<tr key="<%=key%>" class="<%=className%>" style="height: <%=height%>px;"><%=contents%></tr>'),initialize:function(a){View.Base.Painter.prototype.initialize.apply(this,arguments);var b=a&&a.whichSide||"R",c=this.grid.focusModel;this.setOwnProperties({$parent:a.$parent,collection:a.collection,whichSide:b,columnModelList:this.grid.columnModel.getVisibleColumnModelList(b),cellHandlerList:[],_isEventAttached:!1}),this.collection&&this.collection.forEach(function(a){this.listenTo(a,"change",this._onModelChange,this)},this),this.listenTo(c,"select",this._onSelect,this).listenTo(c,"unselect",this._onUnselect,this).listenTo(c,"focus",this._onFocus,this).listenTo(c,"blur",this._onBlur,this)},destroy:function(){this.detachHandlerAll(),this.destroyChildren(),this.remove()},attachHandlerAll:function(){this.attachHandler(this.$parent),this.grid.cellFactory.attachHandler(this.$parent),this._isEventAttached=!0},detachHandlerAll:function(){this._isEventAttached&&(this.detachHandler(this.$parent),this.grid.cellFactory.detachHandler(this.$parent))},_onMouseDown:function(a){var b=$(a.target).closest("td"),c=$(a.target).closest("tr"),d=b.attr("columnName"),e=c.attr("key");this.grid.focus(e,d),"radio"===this.grid.option("selectType")&&this.grid.check(e)},_onModelChange:function(a){var b,c,d,e,f={};_.each(a.changed,function(a,g){d=a.rowKey,f[d]=f[d]||this._getRowElement(d),e=f[d],"_extraData"!==g&&(b=this._getEditType(g,a),c=this.grid.cellFactory.getInstance(b),c.onModelChange(a,e))},this)},_onSelect:function(a){this._setCssSelect(a,!0)},_onUnselect:function(a){this._setCssSelect(a,!1)},_setCssSelect:function(a,b){var c,d,e,f,g=this.grid,h=this.columnModelList,i={};_.each(h,function(h){c=h.columnName,f=g.dataModel.getMainRowKey(a,c),i[f]=i[f]||this._getRowElement(f),d=i[f],e=d.find('td[columnname="'+c+'"]'),e.length&&(b?e.addClass("selected"):e.removeClass("selected"))},this)},_onBlur:function(a,b){var c=this.grid.getElement(a,b);c.length&&c.removeClass("focused")},_onFocus:function(a,b){var c=this.grid.getElement(a,b);c.length&&c.addClass("focused")},_getRowElement:function(a){return this.$parent.find('tr[key="'+a+'"]')},_getEditType:function(a,b){var c=this.grid.columnModel.getEditType(a);return b.isEditable||"_number"===a||(c="normal"),c},getHtml:function(a){if(void 0===a.get("rowKey"))return"";var b,c,d,e,f=this.columnModelList,g=this.grid.cellFactory,h="";return this.cellHandlerList=[],_.each(f,function(f){b=f.columnName,c=a.get(b),c&&c.isMainRow&&(d=this._getEditType(b,c),e=g.getInstance(d),h+=e.getHtml(c),this.cellHandlerList.push({selector:'td[columnName="'+b+'"]',cellInstance:e}))},this),this.baseTemplate({key:a.get("rowKey"),height:this.grid.dimensionModel.get("rowHeight"),contents:h,className:""})}}),View.Base.Painter.Cell=View.Base.Painter.extend({redrawAttributes:["isEditable","optionList","value"],_defaultKeyDownSwitch:{ESC:function(a,b){this.focusOut(b.$target)},ENTER:function(a,b){this.focusOut(b.$target)},TAB:function(a,b){a.shiftKey?this.grid.focusIn(b.rowKey,b.focusModel.prevColumnName(),!0):this.grid.focusIn(b.rowKey,b.focusModel.nextColumnName(),!0)},defaultAction:function(){}},eventHandler:{},initialize:function(){View.Base.Painter.prototype.initialize.apply(this,arguments),this.initializeEventHandler(),this.setOwnProperties({_keyDownSwitch:$.extend({},this._defaultKeyDownSwitch)})},baseTemplate:_.template('<td columnName="<%=columnName%>" <%=rowSpan%> class="<%=className%>" <%=attributes%> data-edit-type="<%=editType%>"><%=content%></td>'),onModelChange:function(a,b){var c,d=b.find('td[columnname="'+a.columnName+'"]'),e=!1;ne.util.forEachArray(this.redrawAttributes,function(b){return-1!==$.inArray(b,a.changed)?(e=!0,!1):void 0},this),d.attr("class",this._getClassNameList(a).join(" ")),c=!!d.find(":focus").length,e===!0?(this.redraw(a,d,c),c&&this.focusIn(d)):this.setElementAttribute(a,d,c)},redraw:function(a,b){this.detachHandler(b);var c={"class":this._getClassNameList(a).join(" ")};a.rowSpan&&(c.rowSpan=a.rowSpan),c=$.extend(c,this.getAttributes(a)),b.attr(c),b.data("edit-type",this.getEditType()).html(this.getContentHtml(a)),this.attachHandler(b)},_getParamForKeyDownSwitch:function(a){var b=this.grid,c=a.keyCode||a.which,d=b.focusModel.which(),e=d.rowKey,f=d.columnName;return{keyDownEvent:a,$target:$(a.target),focusModel:b.focusModel,rowKey:e,columnName:f,keyName:b.keyName[c]}},_executeKeyDownSwitch:function(a){var b=a.keyCode||a.which,c=this.grid.keyName[b],d=this._getParamForKeyDownSwitch(a);return(this._keyDownSwitch[c]||this._keyDownSwitch.defaultAction).call(this,a,d),!!this._keyDownSwitch[c]},setKeyDownSwitch:function(a,b){"object"==typeof a?this._keyDownSwitch=$.extend(this._keyDownSwitch,a):this._keyDownSwitch[a]=b},_onKeyDown:function(a){this._executeKeyDownSwitch(a)&&a.preventDefault()},_getClassNameList:function(a){var b=this.grid.focusModel.which(),c=a.columnName,d=this.grid.dataModel.getMainRowKey(b.rowKey,c),e=[],f={},g=["_button","_number"],h=-1!==$.inArray(c,g);return d===a.rowKey&&(e.push("selected"),b.columnName===c&&e.push("focused")),a.className?e.push(a.className):null,a.isEditable?!h&&e.push("editable"):null,a.isDisabled?e.push("disabled"):null,_.each(e,function(a){f[a]=!0}),e=[],_.each(f,function(a,b){e.push(b)}),e},getHtml:function(a){var b=Util.getAttributesString(this.getAttributes(a));return this.baseTemplate({columnName:a.columnName,rowSpan:a.rowSpan?'rowSpan="'+a.rowSpan+'"':"",className:this._getClassNameList(a).join(" "),attributes:b,editType:this.getEditType(),content:this.getContentHtml(a)})},_getCellData:function(a){return this.grid.renderModel.getCellData(this.getRowKey(a),this.getColumnName(a))},_getCellAddress:function(a){return{rowKey:this.getRowKey(a),columnName:this.getColumnName(a)}},getColumnName:function(a){return a.closest("td").attr("columnName")},getRowKey:function(a){return a.closest("tr").attr("key")},getAttributes:function(){return{}},focusOut:function(){this.grid.focusClipboard()},getEditType:function(){return"normal"},focusIn:function(){},getContentHtml:function(){return""},setElementAttribute:function(){}}),View.Base.Painter.Cell.Interface=function(){},View.Base.Painter.Cell.Interface.prototype.getEditType=function(){},View.Base.Painter.Cell.Interface.prototype.focusIn=function(){},View.Base.Painter.Cell.Interface.prototype.getContentHtml=function(){},View.Base.Painter.Cell.Interface.prototype.setElementAttribute=function(){},View.Painter.Cell.List=View.Base.Painter.Cell.extend({redrawAttributes:["isDisabled","isEditable","optionList"],eventHandler:{},initialize:function(){View.Base.Painter.Cell.prototype.initialize.apply(this,arguments)},getEditType:function(){},focusIn:function(){},getContentHtml:function(){throw this.error("Implement getContentHtml(cellData, $target) method. On re-rendering")},setElementAttribute:function(){throw this.error("Implement setElementAttribute(cellData, $target) method. ")},getOptionList:function(a){var b=this.grid.columnModel.getColumnModel(a.columnName);return a.optionList&&a.optionList.length?a.optionList:b.editOption.list},_onBlur:function(a){var b=$(a.target);b.closest("td").data("isFocused",!1)},_onFocus:function(a){var b=$(a.target);b.closest("td").data("isFocused",!0)}}),View.Painter.Cell.List.Select=View.Painter.Cell.List.extend({initialize:function(){View.Painter.Cell.List.prototype.initialize.apply(this,arguments),this.setKeyDownSwitch({ESC:function(a,b){this.focusOut(b.$target)},ENTER:function(a,b){this.focusOut(b.$target)}})},eventHandler:{"change select":"_onChange","keydown select":"_onKeyDown","blur select":"_onBlur","focus select":"_onFocus"},getEditType:function(){return"select"},focusIn:function(a){a.find("select").focus()},getContentHtml:function(a){var b=this.getOptionList(a),c="",d=a.isDisabled,e=b.length;c+='<select name="'+Util.getUniqueKey()+'"',c+=d?" disabled ":"",c+=">";for(var f=0;e>f;f++)c+="<option ",c+='value="'+b[f].value+'"',a.value==b[f].value&&(c+=" selected"),c+=" >",c+=b[f].text,c+="</option>";return c+="</select>"},setElementAttribute:function(a,b,c){var d=b.find("select");c?d.blur():null,d.val(a.value),c?d.focus():null},_onChange:function(a){var b=$(a.target),c=this._getCellAddress(b),d=this.grid;d.setValue(c.rowKey,c.columnName,b.val())}}),View.Painter.Cell.List.Button=View.Painter.Cell.List.extend({initialize:function(){View.Painter.Cell.List.prototype.initialize.apply(this,arguments),this.setKeyDownSwitch({UP_ARROW:function(){},DOWN_ARROW:function(){},PAGE_UP:function(){},PAGE_DOWN:function(){},ENTER:function(a,b){b.$target.trigger("click")},LEFT_ARROW:function(a,b){this._focusPrevInput(b.$target)},RIGHT_ARROW:function(a,b){this._focusNextInput(b.$target)},ESC:function(a,b){this.focusOut(b.$target)},TAB:function(a,b){a.shiftKey?this._focusPrevInput(b.$target)||this.grid.focusIn(b.rowKey,b.focusModel.prevColumnName(),!0):this._focusNextInput(b.$target)||this.grid.focusIn(b.rowKey,b.focusModel.nextColumnName(),!0)}})},eventHandler:{"change input":"_onChange","keydown input":"_onKeyDown"},template:{input:_.template('<input type="<%=type%>" name="<%=name%>" id="<%=id%>" value="<%=value%>" <%=checked%> <%=disabled%> />'),label:_.template('<label for="<%=id%>" style="margin-right:10px"><%=text%></label>')},getEditType:function(){return"button"},focusIn:function(a){a.find("input").eq(0).focus()},getContentHtml:function(a){for(var b,c=this.getOptionList(a),d=c.length,e=this.grid.columnModel.getColumnModel(a.columnName),f=a.value,g=(""+f).split(","),h="",i=Util.getUniqueKey(),j=a.isDisabled,k=0;d>k;k++)b=i+"_"+c[k].value,h+=this.template.input({type:e.editOption.type,name:i,id:b,value:c[k].value,checked:-1===$.inArray(""+c[k].value,g)?"":"checked",disabled:j?"disabled":""}),c[k].text&&(h+=this.template.label({id:b,text:c[k].text}));return h},setElementAttribute:function(a,b){var c,d=a.value,e=(""+d).split(","),f=e.length;for(b.find("input:checked").prop("checked",!1),c=0;f>c;c++)b.find('input[value="'+e[c]+'"]').prop("checked",!0)},_focusNextInput:function(a){var b=a;do b=b.next();while(b.length&&!b.is("input"));return b.length?(b.focus(),!0):!1},_focusPrevInput:function(a){var b=a;do b=b.prev();while(b.length&&!b.is("input"));return b.length?(b.focus(),!0):!1},_getCheckedValueList:function(a){var b=a.closest("td").find("input:checked"),c=[];return ne.util.forEachArray(b,function(a,d){c.push(b.eq(d).val())}),c},_onChange:function(a){var b=$(a.target),c=this._getCellAddress(b);this.grid.setValue(c.rowKey,c.columnName,this._getCheckedValueList(b).join(","))}}),View.Painter.Cell.Normal=View.Base.Painter.Cell.extend({initialize:function(){View.Base.Painter.Cell.prototype.initialize.apply(this,arguments)},getEditType:function(){return"normal"},getContentHtml:function(a){var b=a.columnName,c=this.grid.columnModel.getColumnModel(b),d=this.grid.dataModel.get(a.rowKey).getHTMLEncodedString(b),e=a.rowKey;return"function"==typeof c.formatter&&(d=c.formatter(d,this.grid.dataModel.get(e).toJSON(),c)),d},focusIn:function(){this.grid.focusClipboard()},setElementAttribute:function(){}}),View.Painter.Cell.Normal.Number=View.Painter.Cell.Normal.extend({redrawAttributes:[],initialize:function(){View.Painter.Cell.Normal.prototype.initialize.apply(this,arguments)},getEditType:function(){return"_number"},getContentHtml:function(a){return a.value}}),View.Painter.Cell.MainButton=View.Base.Painter.Cell.extend({redrawAttributes:["isDisabled","isEditable","optionList"],eventHandler:{mousedown:"_onMouseDown","change input":"_onChange","keydown input":"_onKeyDown"},initialize:function(){View.Base.Painter.Cell.prototype.initialize.apply(this,arguments),this.setKeyDownSwitch({UP_ARROW:function(){},DOWN_ARROW:function(){},ENTER:function(a,b){this.focusOut(b.$target)},LEFT_ARROW:function(){},RIGHT_ARROW:function(){},ESC:function(){}})},template:_.template('<input type="<%=type%>" name="<%=name%>" <%=checked%> <%=disabled%>/>'),getEditType:function(){return"_button"},getContentHtml:function(a){var b=a.isDisabled;return this.template({type:this.grid.option("selectType"),name:this.grid.id,checked:a.value?"checked":"",disabled:b?"disabled":""})},focusIn:function(){},setElementAttribute:function(a,b){var c=b.find("input"),d=c.prop("checked");d!==!!a.value&&c.prop("checked",a.value)},toggle:function(a){var b=a.find("input");"checkbox"===this.grid.option("selectType")&&b.trigger("click")},getAttributes:function(){return{align:"center"}},_onChange:function(a){var b=$(a.target),c=this.getRowKey(b);this.grid.setValue(c,"_button",b.prop("checked"))},_onMouseDown:function(a){var b=$(a.target);b.is("input")||b.find("input").trigger("click")}}),View.Painter.Cell.Text=View.Base.Painter.Cell.extend({redrawAttributes:["isEditable"],eventHandler:{"blur input":"_onBlur","keydown input":"_onKeyDown","focus input":"_onFocus"},initialize:function(){View.Base.Painter.Cell.prototype.initialize.apply(this,arguments),this.setOwnProperties({originalText:""}),this.setKeyDownSwitch({UP_ARROW:function(){},DOWN_ARROW:function(){},PAGE_UP:function(){},PAGE_DOWN:function(){},ENTER:function(a,b){this.focusOut(b.$target)},ESC:function(a,b){this._restore(b.$target),this.focusOut(b.$target)}})},template:_.template('<input type="text" value="<%=value%>" name="<%=name%>" <%=disabled%>/>'),getEditType:function(){return"text"},focusIn:function(a){var b=a.find("input");ne.util.setCursorToEnd(b.get(0)),b.focus().select()},focusOut:function(){this.grid.focusClipboard()},getContentHtml:function(a){var b=this.grid.dataModel.get(a.rowKey).getHTMLEncodedString(a.columnName);return this.template({value:b,disabled:a.isDisabled?"disabled":"",name:Util.getUniqueKey()})},setElementAttribute:function(a,b){var c=-1!==$.inArray("value",a.changed),d=b.find("input");c&&d.val(a.value),d.prop("disabled",a.isDisabled)},_isEdited:function(a){return a.val()!==this.originalText},_restore:function(a){a.val(this.originalText)},_onBlur:function(a){var b=$(a.target),c=this.getRowKey(b),d=this.getColumnName(b);this._isEdited(b)&&this.grid.setValue(c,d,b.val()),this.grid.selection.enable()},_onFocus:function(a){var b=$(a.target);this.originalText=b.val(),this.grid.selection.disable()}}),View.Painter.Cell.Text.Convertible=View.Painter.Cell.Text.extend({redrawAttributes:["isDisabled","isEditable","value"],eventHandler:{click:"_onClick","blur input":"_onBlurConvertible","keydown input":"_onKeyDown","focus input":"_onFocus"},initialize:function(){View.Painter.Cell.Text.prototype.initialize.apply(this,arguments),this.setOwnProperties({timeoutIdForClick:0})},getEditType:function(){return"text-convertible"},focusIn:function(a){this._startEdit(a)},focusOut:function(a){this._endEdit(a),this.grid.focusClipboard()},getContentHtml:function(a){var b=this.grid.dataModel.get(a.rowKey).getHTMLEncodedString(a.columnName),c=this.grid.getElement(a.rowKey,a.columnName),d=!(!c.length||!c.data("isEdit"));return d?this.template({value:b,disabled:a.isDisabled?"disabled":"",name:Util.getUniqueKey()}):b},setElementAttribute:function(){},_onBlurConvertible:function(a){var b=$(a.target),c=b.closest("td");this._onBlur(a),this._endEdit(c)},_startEdit:function(a){var b,c=a.data("isEdit"),d=this.getRowKey(a),e=this.getColumnName(a),f=this.grid.dataModel.get(d).getCellState(e);c||!f.isEditable||f.isDisabled||(a.data("isEdit",!0),this.redraw(this._getCellData(a),a),b=a.find("input"),this.originalText=b.val(),ne.util.setCursorToEnd(b.get(0)),b.focus().select())},_endEdit:function(a){var b=a.data("isEdit");b&&(a.data("isEdit",!1),this.redraw(this._getCellData(a),a))},_onClick:function(a){var b=$(a.target),c=b.closest("td"),d=c.data("clicked");d?this._startEdit(c):(c.data("clicked",!0),clearTimeout(this.timeoutIdForClick),this.timeoutIdForClick=setTimeout(function(){c.data("clicked",!1)},400))}}),View.CellFactory=View.Base.extend({initialize:function(){View.Base.prototype.initialize.apply(this,arguments),this._initializeInstances()},_initializeInstances:function(){var a={},b={grid:this.grid},c=[new View.Painter.Cell.MainButton(b),new View.Painter.Cell.Normal.Number(b),new View.Painter.Cell.Normal(b),new View.Painter.Cell.Text(b),new View.Painter.Cell.List.Button(b),new View.Painter.Cell.List.Select(b),new View.Painter.Cell.Text.Convertible(b)];_.each(c,function(b){a[b.getEditType()]=b},this),this.setOwnProperties({instances:a})},getInstance:function(a){var b=this.instances[a];return b||(b="radio"===a||"checkbox"===a?this.instances.button:this.instances.normal),b},attachHandler:function(a){var b,c,d=a.find("td");_.each(d,function(a,e){b=d.eq(e),c=b.data("edit-type"),this.instances[c]&&this.instances[c].attachHandler(b)},this)},detachHandler:function(a){var b,c,d=a.find("td");_.each(d,function(a,e){b=d.eq(e),c=b.data("edit-type"),this.instances[c]&&this.instances[c].detachHandler(b)},this)}}),View.Clipboard=View.Base.extend({tagName:"textarea",className:"clipboard",events:{keydown:"_onKeyDown",focus:"_onFocus",blur:"_onBlur"},_onFocus:function(){this.grid.focusModel.focus()},_onBlur:function(){this.grid.focusModel.blur()},initialize:function(){View.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({timeoutIdForCopy:0,timeoutIdForKeyIn:0,isLocked:!1})},render:function(){return this},_lock:function(){clearTimeout(this.timeoutIdForKeyIn),this.isLocked=!0,this.timeoutIdForKeyIn=setTimeout($.proxy(this._unlock,this),10)},_unlock:function(){this.isLocked=!1},_onKeyDown:function(a){a.keyCode||a.which;return this.isLocked?(a.preventDefault(),!1):(a.shiftKey&&(a.ctrlKey||a.metaKey)?this._keyInWithShiftAndCtrl(a):a.shiftKey?this._keyInWithShift(a):a.ctrlKey||a.metaKey?this._keyInWithCtrl(a):this._keyIn(a),void this._lock())},_keyIn:function(a){var b=this.grid,c=b.keyMap,d=b.focusModel,e=b.selection,f=d.which(),g=f.rowKey,h=f.columnName,i=b.dimensionModel.getDisplayRowCount(),j=!0,k=a.keyCode||a.which;switch(k){case c.UP_ARROW:b.focus(d.prevRowKey(),h,!0);break;case c.DOWN_ARROW:b.focus(d.nextRowKey(),h,!0);break;case c.LEFT_ARROW:b.focus(g,d.prevColumnName(),!0);break;case c.RIGHT_ARROW:b.focus(g,d.nextColumnName(),!0);break;case c.PAGE_UP:b.focus(d.prevRowKey(i-1),h,!0);break;case c.PAGE_DOWN:b.focus(d.nextRowKey(i-1),h,!0);break;case c.HOME:b.focus(g,d.firstColumnName(),!0);break;case c.END:b.focus(g,d.lastColumnName(),!0);break;case c.SPACE:case c.ENTER:this._onEnterSpace(g,h);break;case c.DEL:this._del(g,h);break;case c.TAB:b.focusIn(g,d.nextColumnName(),!0);break;case c.CHAR_V:break;default:j=!1}return a.preventDefault(),e.endSelection(),j},_onEnterSpace:function(a,b){var c,d=this.grid,e=this.grid.columnModel.getEditType(b);"_button"===e?(c=this.grid.cellFactory.getInstance(e),c.toggle(d.getElement(a,b))):d.focusIn(a,b)},_keyInWithShift:function(a){var b=this.grid,c=b.keyMap,d=b.focusModel,e=b.columnModel.getVisibleColumnModelList(),f=b.focusModel.indexOf(),g=d.which(),h=!0,i=b.dimensionModel.getDisplayRowCount(),j=a.keyCode||a.which;switch(j){case c.UP_ARROW:this._updateSelectionByKeyIn(d.prevRowIndex(),f.columnIdx);break;case c.DOWN_ARROW:this._updateSelectionByKeyIn(d.nextRowIndex(),f.columnIdx);break;case c.LEFT_ARROW:this._updateSelectionByKeyIn(f.rowIdx,d.prevColumnIndex());break;case c.RIGHT_ARROW:this._updateSelectionByKeyIn(f.rowIdx,d.nextColumnIndex());break;case c.PAGE_UP:this._updateSelectionByKeyIn(d.prevRowIndex(i-1),f.columnIdx);break;case c.PAGE_DOWN:this._updateSelectionByKeyIn(d.nextRowIndex(i-1),f.columnIdx);break;case c.HOME:this._updateSelectionByKeyIn(f.rowIdx,0);break;case c.END:this._updateSelectionByKeyIn(f.rowIdx,e.length-1);break;case c.ENTER:break;case c.TAB:b.focusIn(g.rowKey,d.prevColumnName(),!0);break;case c.CHAR_V:break;default:h=!1}return a.preventDefault(),h},_keyInWithCtrl:function(a){var b=this.grid,c=b.keyMap,d=b.focusModel,e=!0,f=a.keyCode||a.which;switch(f){case c.CHAR_A:this.grid.selection.selectAll();break;case c.CHAR_C:this._copyToClipboard();break;case c.HOME:b.focus(d.firstRowKey(),d.firstColumnName(),!0);break;case c.END:b.focus(d.lastRowKey(),d.lastColumnName(),!0);break;case c.CHAR_V:break;default:e=!1}return e},_keyInWithShiftAndCtrl:function(a){var b=this.grid,c=b.keyMap,d=!0,e=b.columnModel.getVisibleColumnModelList(),f=a.keyCode||a.which;switch(f){case c.HOME:this._updateSelectionByKeyIn(0,0);break;case c.END:this._updateSelectionByKeyIn(b.dataModel.length-1,e.length-1);break;default:d=!1}return a.preventDefault(),d},_del:function(){var a,b,c,d=this.grid,e=d.selection,f=d.dataModel,g=d.focusModel.which(),h=d.columnModel.getVisibleColumnModelList(),i=g.rowKey,j=g.columnName;if(e.hasSelection()){for(a=e.getRange(),b=a.row[0];b<a.row[1]+1;b++)for(i=f.at(b).get("rowKey"),c=a.column[0];c<a.column[1]+1;c++)j=h[c].columnName,d.del(i,j,!0);d.renderModel.refresh()}else d.del(i,j)},_updateSelectionByKeyIn:function(a,b){var c=this.grid.selection,d=this.grid.focusModel.indexOf();c.hasSelection()||c.startSelection(d.rowIdx,d.columnIdx),c.updateSelection(a,b),this.grid.focusAt(a,b,!0)},_getClipboardString:function(){var a,b=this.grid.selection,c=this.grid.focusModel.which();return a=b.isShown()?this.grid.selection.getSelectionToString():this.grid.dataModel.get(c.rowKey).getVisibleText(c.columnName)},_copyToClipboard:function(){var a=this._getClipboardString();window.clipboardData?window.clipboardData.setData("Text",a)?this.$el.select():this.$el.val("").select():this.$el.val(a).select(),this.timeoutIdForCopy=setTimeout($.proxy(function(){this.$el.val("")},this),0)}}),View.RowList=View.Base.extend({initialize:function(a){View.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:a&&a.whichSide||"R",timeoutIdForCollection:0,rowPainter:null}),this._createRowPainter(),this.listenTo(this.grid.renderModel,"rowListChanged",this.render,this)},_createRowPainter:function(){this.rowPainter=this.createView(View.Painter.Row,{grid:this.grid,$parent:this.$el,collection:this.collection,whichSide:this.whichSide})},render:function(){var a="",b=this.collection.at(0);return this.rowPainter.detachHandlerAll(),this.destroyChildren(),this._createRowPainter(),b&&"undefined"!==b.get("rowKey")&&this.collection.forEach(function(b){a+=this.rowPainter.getHtml(b)},this),this.$el.html("").prepend(a),this.rowPainter.attachHandlerAll(),this._showLayer(),this},_showLayer:function(){this.grid.dataModel.length?this.grid.hideGridLayer():this.grid.showGridLayer("empty")}}),View.Selection=View.Base.extend({events:{},initialize:function(){View.Base.prototype.initialize.apply(this,arguments),this.setOwnProperties({range:{column:[-1,-1],row:[-1,-1]},spannedRange:{column:[-1,-1],row:[-1,-1]},lside:null,rside:null,pageX:0,pageY:0,intervalIdForAutoScroll:0,isEnable:!0,_isShown:!1}),this.listenTo(this.grid.dimensionModel,"columnWidthChanged",this._onColumnWidthChanged,this).listenTo(this.grid.dataModel,"add remove sort reset",this.endSelection,this)},enable:function(){this.isEnable=!0},disable:function(){this.endSelection(),this.isEnable=!1},attachMouseEvent:function(a,b){this.isEnable&&(this.setOwnProperties({pageX:a,pageY:b}),this.grid.updateLayoutData(),$(document).on("mousemove",$.proxy(this._onMouseMove,this)),$(document).on("mouseup",$.proxy(this._onMouseUp,this)),$(document).on("selectstart",$.proxy(this._onSelectStart,this)))},detachMouseEvent:function(){clearInterval(this.intervalIdForAutoScroll),$(document).off("mousemove",$.proxy(this._onMouseMove,this)),$(document).off("mouseup",$.proxy(this._onMouseUp,this)),$(document).off("selectstart",$.proxy(this._onSelectStart,this))},_onMouseMove:function(a){var b;clearInterval(this.intervalIdForAutoScroll),this.hasSelection()?(b=this.getIndexFromMousePosition(a.pageX,a.pageY),this.updateSelection(b.row,b.column),this.grid.focusAt(b.row,b.column),this._isAutoScrollable(b.overflowX,b.overflowY)&&(this.intervalIdForAutoScroll=setInterval($.proxy(this._adjustScroll,this,b.overflowX,b.overflowY)))):this._getDistance(a)>10&&(b=this.getIndexFromMousePosition(this.pageX,this.pageY),this.startSelection(b.row,b.column))},_isAutoScrollable:function(a,b){return!(0===a&&0===b)},_adjustScroll:function(a,b){var c=this.grid.renderModel,d=c.get("scrollLeft"),e=c.get("maxScrollLeft"),f=c.get("scrollTop");0>a?c.set("scrollLeft",Math.min(Math.max(0,d-40),e)):a>0&&c.set("scrollLeft",Math.min(Math.max(0,d+40),e)),0>b?c.set("scrollTop",Math.max(0,f-40)):b>0&&c.set("scrollTop",Math.max(0,f+40))},_getDistance:function(a){var b=a.pageX,c=a.pageY,d=Math.abs(this.pageX-b),e=Math.abs(this.pageY-c);return Math.round(Math.sqrt(Math.pow(d,2)+Math.pow(e,2)))},_onMouseUp:function(){this.detachMouseEvent()},getIndexFromMousePosition:function(a,b){var c,d,e=this._getContainerPosition(a,b),f=this.grid.dimensionModel,g=this.grid.renderModel,h=f.getColumnWidthList(),i=g.get("scrollTop"),j=g.get("scrollLeft"),k=f.getFrameWidth(),l=e.pageY+i,m=e.pageX,n=0,o=0,p=f.get("lsideWidth")>e.pageX,q=h.length,r=0,s=this.grid.option("scrollX")?f.get("bodyHeight")-this.grid.scrollBarSize:f.get("bodyHeight"),t=this.grid.option("scrollY")?f.get("width")-this.grid.scrollBarSize:f.get("width");return p||(m+=j),c=Math.max(0,Math.min(Math.floor(l/(f.get("rowHeight")+1)),this.grid.dataModel.length-1)),e.pageY<0?o=-1:e.pageY>s&&(o=1),e.pageX<0?n=-1:e.pageX>t&&(n=1),0>m?d=0:m>k?d=q-1:ne.util.forEachArray(h,function(a,b){return r+=a+1,r>=m?(d=b,!1):void 0}),{row:c,column:d,overflowX:n,overflowY:o}},getRange:function(){return $.extend(!0,{},this.spannedRange)},getSelectionToString:function(){var a,b,c=this.grid.columnModel.get("columnModelList").slice(this.spannedRange.column[0],this.spannedRange.column[1]+1),d={_button:!0},e=(c.length,[]),f=[],g=[],h=this.spannedRange.row[0];return _.each(c,function(a){e.push(a.columnName)}),a=this.grid.dataModel.slice(this.spannedRange.row[0],this.spannedRange.row[1]+1),_.each(a,function(a,b){f=[],_.each(e,function(c,g){d[c]||f.push("_number"===e[g]?h+b+1:a.getVisibleText(c))}),g.push(f.join("	"))}),b=g.join("\n")},createLayer:function(a){var b="R"===a?View.Selection.Layer.Rside:View.Selection.Layer.Lside,c=this._getLayer(a);
return c&&c.destroy?c.destroy():null,c=this.createView(b,{grid:this.grid,columnWidthList:this.grid.dimensionModel.getColumnWidthList(a)}),"R"===a?this.rside=c:this.lside=c,c},selectAll:function(){this.startSelection(0,0),this.updateSelection(this.grid.dataModel.length-1,this.grid.columnModel.getVisibleColumnModelList().length-1)},startSelection:function(a,b){this.range.row[0]=this.range.row[1]=a,this.range.column[0]=this.range.column[1]=b,this.show()},updateSelection:function(a,b){this.range.row[1]=a,this.range.column[1]=b,this.show()},endSelection:function(){this.range.row[0]=this.range.row[1]=this.range.column[0]=this.range.column[1]=-1,this.spannedRange.row[0]=this.spannedRange.row[1]=this.spannedRange.column[0]=this.spannedRange.column[1]=-1,this.hide(),this.detachMouseEvent()},_onColumnWidthChanged:function(){this.show()},show:function(){if(this.hasSelection()){this._isShown=!0;var a,b=this.grid.dataModel,c=this.grid.columnModel.get("columnFixIndex"),d=(this.grid.dimensionModel.get("rowHeight"),Math.min.apply(Math,this.range.row)),e=Math.max.apply(Math,this.range.row),f=Math.min.apply(Math,this.range.column),g=Math.max.apply(Math,this.range.column),h={row:[d,e],column:[f,g]};if(b.isRowSpanEnable()){a=$.extend([],h.row);do a=$.extend([],h.row),h=this._getRowSpannedIndex(h);while(h.row[0]!==a[0]||h.row[1]!==a[1])}this.spannedRange=h,this.lside.show(h),this.rside.show({row:h.row,column:[Math.max(-1,h.column[0]-c),Math.max(-1,h.column[1]-c)]}),this.grid.focusClipboard()}},hide:function(){this._isShown=!1,this.lside.hide(),this.rside.hide()},isShown:function(){return this._isShown},_getLayer:function(a){return"R"===a?this.rside:this.lside},_getContainerPosition:function(a,b){var c=this.grid.dimensionModel,d=a-c.get("offsetLeft"),e=b-(c.get("offsetTop")+c.get("headerHeight")+2);return{pageX:d,pageY:e}},_onSelectStart:function(a){a.preventDefault()},hasSelection:function(){return!(-1===this.range.row[0])},_getRowSpannedIndex:function(a){function b(a){var b,c=a.startIndex,d=a.endIndex,e=a.startRowSpanDataMap&&a.startRowSpanDataMap[k],f=a.startIndexList,g=a.endIndexList;e&&(e.isMainRow?(b=c+e.count-1,b>d&&g.push(b)):(b=c+e.count,f.push(b)))}function c(a){var b,c,d=a.endIndex,e=a.columnName,f=a.endRowSpanDataMap&&a.endRowSpanDataMap[e],g=a.endIndexList,h=a.dataModel;f&&(f.isMainRow?(b=d+f.count-1,g.push(b)):(b=d+f.count,c=h.at(b).getRowSpanData(e),b+=c.count-1,b>d&&g.push(b)))}var d=this.grid.columnModel.get("columnModelList").slice(a.column[0],a.column[1]+1),e=this.grid.dataModel,f=[a.row[0]],g=[a.row[1]],h=e.at(a.row[0]),i=e.at(a.row[1]),j=$.extend({},a);if(h&&i){var k,l,m=e.at(a.row[0]).getRowSpanData(),n=e.at(a.row[1]).getRowSpanData();_.each(d,function(d){k=d.columnName,l={columnName:k,startIndex:a.row[0],endIndex:a.row[1],endRowSpanDataMap:n,startRowSpanDataMap:m,startIndexList:f,endIndexList:g,dataModel:e},b(l),c(l)},this),j.row=[Math.min.apply(Math,f),Math.max.apply(Math,g)]}return j},destroy:function(){this.detachMouseEvent(),this.destroyChildren(),this.remove()}}),View.Selection.Layer=View.Base.extend({tagName:"div",className:"selection_layer",initialize:function(a){View.Base.prototype.initialize.apply(this,arguments),this.listenTo(this.grid.dimensionModel,"columnWidthChanged",this._updateColumnWidthList,this),this.setOwnProperties({columnWidthList:a.columnWidthList,spannedRange:{row:[-1,-1],column:[-1,-1]},whichSide:"R"})},_updateColumnWidthList:function(){this.columnWidthList=this.grid.dimensionModel.getColumnWidthList(this.whichSide)},_getGeometryStyles:function(a){a=a||this.indexObj;var b,c,d=this.columnWidthList,e=a.row,f=a.column,g=this.grid.dimensionModel.get("rowHeight"),h=Util.getHeight(e[0],g)+1,i=Util.getHeight(e[1]-e[0]+1,g)-3,j=d.length,k="block",l=0,m=0;for(c=0;c<f[1]+1&&j>c;c++)c<f[0]?l+=d[c]+1:m+=d[c]+1;return m-=1,(0>=m||0>=i)&&(k="none"),b={display:k,width:m+"px",height:i+"px",top:h+"px",left:l+"px"}},show:function(a){this.indexObj=a,this.$el.css(this._getGeometryStyles(a))},hide:function(){this.$el.css({display:"none",width:"0px",height:"0px",top:0,left:0})},render:function(){return this}}),View.Selection.Layer.Lside=View.Selection.Layer.extend({initialize:function(){View.Selection.Layer.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:"L"})}}),View.Selection.Layer.Rside=View.Selection.Layer.extend({initialize:function(){View.Selection.Layer.prototype.initialize.apply(this,arguments),this.setOwnProperties({whichSide:"R"})}}),AddOn.Net=View.Base.extend({events:{submit:"_onSubmit"},initialize:function(a){View.Base.prototype.initialize.apply(this,arguments);var b={initialRequest:!0,api:{readData:"",updateData:"",deleteData:"",modifyData:"",downloadData:"",downloadAllData:""},perPage:500,enableAjaxHistory:!0},c=$.extend(!0,b,a),d=this.grid.getPaginationInstance();this.setOwnProperties({curPage:1,perPage:c.perPage,options:c,router:null,pagination:d,requestedFormData:null,isLocked:!1}),this._initializeDataModelNetwork(),this._initializeRouter(),this._initializePagination(),c.initialRequest&&this.readDataAt(1,!1)},_initializePagination:function(){var a=this.pagination;a&&(a._setOption("itemPerPage",this.perPage),a._setOption("itemCount",1),a.attach("beforeMove",$.proxy(this._onPageBeforeMove,this)))},_initializeDataModelNetwork:function(){this.grid.dataModel.url=this.options.api.readData,this.grid.dataModel.sync=$.proxy(this._sync,this)},_initializeRouter:function(){this.options.enableAjaxHistory&&(this.router=new AddOn.Net.Router({grid:this.grid,net:this}),!Backbone.History.started&&Backbone.history.start())},_onPageBeforeMove:function(a){var b=a.page;this.curPage!==b&&this.readDataAt(b,!0)},_onSubmit:function(a){a.preventDefault(),this.readDataAt(1,!1)},setFormData:function(a){ne.util.setFormData(this.$el,a)},_sync:function(a,b,c){var d;"read"===a?(c=c||{},d=$.extend({},c),c.url||(d.url=_.result(b,"url")),this._ajax(d)):Backbone.sync.call(Backbone,a,b,c)},lock:function(){this.grid.showGridLayer("loading"),this.isLocked=!0},unlock:function(){this.isLocked=!1},_getFormData:function(){return ne.util.getFormData(this.$el)},_onReadSuccess:function(a,b){var c,d,e=this.pagination;e&&b.pagination&&(c=b.pagination.page,d=b.pagination.totalCount,e._setOption("itemPerPage",this.perPage),e._setOption("itemCount",d),e.movePageTo(c),this.curPage=c)},_onReadError:function(){},readData:function(a){var b=1,c=this.grid;this.isLocked||(c.renderModel.initializeVariables(),this.lock(),this.requestedFormData=_.clone(a),this.curPage=a.page||this.curPage,b=(this.curPage-1)*this.perPage+1,c.renderModel.set({startNumber:b}),a.columnModel=$.toJSON(this.grid.columnModel.get("columnModelList")),c.dataModel.fetch({requestType:"readData",data:a,type:"POST",success:$.proxy(this._onReadSuccess,this),error:$.proxy(this._onReadError,this),reset:!0}))},readDataAt:function(a,b){b=void 0===b?!0:b;var c=b?this.requestedFormData:this._getFormData();c.page=a,c.perPage=this.perPage,this.router&&this.router.navigate("read/"+Util.toQueryString(c),{trigger:!1}),this.readData(c)},createData:function(a){this.send("createData",a)},updateData:function(a){this.send("updateData",a)},deleteData:function(a){this.send("deleteData",a)},modifyData:function(a){this.send("modifyData",a)},downloadData:function(){},downloadAllData:function(){},send:function(a,b){var c={url:this.options.api[a],type:null,hasDataParam:!0,isOnlyChecked:!0,isOnlyModified:!0,isSkipConfirm:!1},d=$.extend(c,b),e=this._getRequestParam(a,d);e&&this._ajax(e)},_getDataParam:function(a,b){var c={hasDataParam:!0,isOnlyModified:!0,isOnlyChecked:!0};b=$.extend(c,b);var d,e=b.hasDataParam,f=b.isOnlyModified,g=b.isOnlyChecked,h=this.grid.dataModel,i={createData:["createList"],updateData:["updateList"],deleteData:["deleteList"],modifyData:["createList","updateList","deleteList"]},j=i[a],k=$.extend({},this.requestedFormData),l=0;return e&&(f?(d=h.getModifiedRowList({isOnlyChecked:g}),_.each(d,function(a,b){-1!==$.inArray(b,j)&&(l+=a.length),d[b]=JSON.stringify(a)},this)):(d={rowList:h.getRowList(g)},l=d.rowList.length)),k=$.extend(k,d),{data:k,count:l}},_getRequestParam:function(a,b){var c,d={url:this.options.api[a],type:null,hasDataParam:!0,isOnlyModified:!0,isOnlyChecked:!0},e=$.extend(d,b),f=this._getDataParam(a,e);return this._isConfirmed(a,f.count)?c={requestType:a,url:e.url,data:f.data,type:e.type}:void 0},_isConfirmed:function(a,b){return b>0?confirm(this._getConfirmMessage(a,b)):(alert(this._getConfirmMessage(a,b)),!1)},_getConfirmMessage:function(a,b){var c={createData:"입력",updateData:"수정",deleteData:"삭제",modifyData:"반영"},d=c[a];return b>0?b+"건의 데이터를 "+d+"하시겠습니까?":d+"할 데이터가 없습니다."},_ajax:function(a){var b=this.createEventData(a.data);if(this.grid.trigger("beforeRequest",b),!b.isStopped()){a=$.extend({requestType:""},a);var c={url:a.url,data:a.data||{},type:a.type||"POST",dataType:a.dataType||"json",complete:$.proxy(this._onComplete,this,a.complete,a),success:$.proxy(this._onSuccess,this,a.success,a),error:$.proxy(this._onError,this,a.error,a)};a.url&&$.ajax(c)}},_onComplete:function(){this.unlock()},_onSuccess:function(a,b,c,d,e){var f=c&&c.message,g=this.createEventData({httpStatus:d,requestType:b.requestType,requestParameter:b.data,responseData:c});if(this.grid.trigger("onResponse",g),!g.isStopped())if(c&&c.result){if(this.grid.trigger("onSuccessResponse",g),g.isStopped())return;a&&"function"==typeof a?a(c.data||{},d,e):null}else{if(this.grid.trigger("onFailResponse",g),g.isStopped())return;f?alert(f):null}},_onError:function(a,b,c,d){var e=this.createEventData({httpStatus:d,requestType:b.requestType,requestParameter:b.data,responseData:null});this.grid.hideGridLayer(),this.grid.trigger("onResponse",e),e.isStopped()||(this.grid.trigger("onErrorResponse",e),e.isStopped()||c.readyState>1&&alert("데이터 요청 중에 에러가 발생하였습니다.\n\n다시 시도하여 주시기 바랍니다."))}}),AddOn.Net.Router=Backbone.Router.extend({routes:{"read/:queryStr":"read"},initialize:function(a){this.setOwnProperties({grid:a&&a.grid||null,net:a&&a.net||null})},read:function(a){var b=Util.toQueryObject(a);this.net.setFormData(b),this.net.readData(b)},setOwnProperties:function(a){_.each(a,function(a,b){this[b]=a},this)}});var Grid=View.Base.extend({scrollBarSize:17,minimumHeight:150,lside:null,rside:null,toolbar:null,cellFactory:null,events:{click:"_onClick",mousedown:"_onMouseDown"},keyMap:{TAB:9,ENTER:13,CTRL:17,ESC:27,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,CHAR_A:65,CHAR_C:67,CHAR_F:70,CHAR_R:82,CHAR_V:86,LEFT_WINDOW_KEY:91,F5:116,BACKSPACE:8,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,DEL:46,UNDEFINED:229},keyName:{9:"TAB",13:"ENTER",17:"CTRL",27:"ESC",37:"LEFT_ARROW",38:"UP_ARROW",39:"RIGHT_ARROW",40:"DOWN_ARROW",65:"CHAR_A",67:"CHAR_C",70:"CHAR_F",82:"CHAR_R",86:"CHAR_V",91:"LEFT_WINDOW_KEY",116:"F5",8:"BACKSPACE",32:"SPACE",33:"PAGE_UP",34:"PAGE_DOWN",36:"HOME",35:"END",46:"DEL",229:"UNDEFINED"},initialize:function(a){View.Base.prototype.initialize.apply(this,arguments);var b=Util.getUniqueKey();this.__instance[b]=this,this.id=b,this._initializeOptions(a),this._initializeProperties(),this._initializeModel(),this._initializeListener(),this._initializeView(),this._initializeScrollBar(),this._attachExtraEvent(),this.render(),this.updateLayoutData()},_initializeOptions:function(a){var b={columnFixIndex:0,columnModelList:[],keyColumnName:null,selectType:"",autoNumbering:!0,headerHeight:35,rowHeight:27,displayRowCount:10,minimumColumnWidth:50,notUseSmartRendering:!1,columnMerge:[],minimumWidth:300,scrollX:!0,scrollY:!0,useDataCopy:!0,toolbar:{hasResizeHandler:!0,hasControlPanel:!0,hasPagination:!0}};this.options=$.extend(!0,b,a)},_initializeProperties:function(){this.setOwnProperties({cellFactory:null,selection:null,columnModel:null,dataModel:null,renderModel:null,layoutModel:null,focusModel:null,addOn:{},view:{lside:null,rside:null,toolbar:null,clipboard:null,layer:{ready:null,loading:null,empty:null}},timeoutIdForResize:0,timeoutIdForSetRowList:0,__$el:this.$el.clone()})},_initializeModel:function(){var a=this.$el.offset();this.columnModel=new Data.ColumnModel({grid:this,hasNumberColumn:this.option("autoNumbering"),keyColumnName:this.option("keyColumnName"),columnFixIndex:this.option("columnFixIndex"),selectType:this.option("selectType")}),this.setColumnModelList(this.option("columnModelList")),this.dimensionModel=new Model.Dimension({grid:this,offsetTop:a.top,offsetLeft:a.left,width:this.$el.width(),height:this.$el.height(),headerHeight:this.option("headerHeight"),rowHeight:this.option("rowHeight"),scrollX:!!this.option("scrollX"),scrollBarSize:this.scrollBarSize,minimumColumnWidth:this.option("minimumColumnWidth"),displayRowCount:this.option("displayRowCount")}),this.focusModel=new Model.Focus({grid:this,scrollX:!!this.option("scrollX"),scrollY:!!this.option("scrollY"),scrollBarSize:this.scrollBarSize}),this.dataModel=new Data.RowList([],{grid:this}),this.dataModel.reset([]),this.renderModel=this.option("notUseSmartRendering")===!0?new Model.Renderer({grid:this}):new Model.Renderer.Smart({grid:this}),this.cellFactory=this.createView(View.CellFactory,{grid:this})},_initializeView:function(){this.cellFactory=this.createView(View.CellFactory,{grid:this}),this.selection=this.createView(View.Selection,{grid:this}),this.view.lside=this.createView(View.Layout.Frame.Lside,{grid:this}),this.view.rside=this.createView(View.Layout.Frame.Rside,{grid:this}),this.view.toolbar=this.createView(View.Layout.Toolbar,{grid:this}),this.view.layer.ready=this.createView(View.Layer.Ready,{grid:this}),this.view.layer.empty=this.createView(View.Layer.Empty,{grid:this}),this.view.layer.loading=this.createView(View.Layer.Loading,{grid:this}),this.view.clipboard=this.createView(View.Clipboard,{grid:this})},_initializeListener:function(){this.listenTo(this.dimensionModel,"change:width",this._onWidthChange).listenTo(this.dimensionModel,"change:bodyHeight",this._setHeight).listenTo(this.focusModel,"select",this._onRowSelectChanged)},_initializeScrollBar:function(){},_attachExtraEvent:function(){$(window).on("resize",$.proxy(this._onWindowResize,this))},_onWindowResize:function(){var a=Math.max(this.option("minimumWidth"),this.$el.css("width","100%").width());this.dimensionModel.set("width",a)},_onClick:function(a){var b=$(a.target),c=this.createEventData(a);this.trigger("click",c),c.isStopped()||!(b.is("input")||b.is("a")||b.is("button")||b.is("select")||b.is("label"))},_onMouseDown:function(a){var b=$(a.target),c=this.createEventData(a);this.trigger("mousedown",c),c.isStopped()||b.is("input")||b.is("a")||b.is("button")||b.is("select")||(a.preventDefault(),this.focusClipboard(),this.selection.show())},_onRowSelectChanged:function(a){"radio"===this.columnModel.get("selectType")&&(this.uncheckAll(),this.check(a))},_onWidthChange:function(){this.updateLayoutData()},updateLayoutData:function(){var a=this.$el.offset(),b=this.dimensionModel.getFrameWidth("R"),c=b-this.dimensionModel.get("rsideWidth");this.renderModel.set({maxScrollLeft:c}),this.dimensionModel.set({offsetTop:a.top,offsetLeft:a.left,width:this.$el.width(),height:this.$el.height(),toolbarHeight:this.view.toolbar.$el.height()})},option:function(a,b){return void 0===b?this.options[a]:(this.options[a]=b,this)},focusClipboard:function(){this.view.clipboard.$el.focus()},render:function(){var a=$("<div>").addClass("left_line"),b=$("<div>").addClass("right_line");this.$el.addClass("grid_wrapper").addClass("uio_grid").attr("instanceId",this.id).append(this.view.layer.empty.render().el).append(this.view.layer.loading.render().el).append(this.view.layer.ready.render().el),this.view.layer.loading.show("초기화 중입니다."),this.$el.append(this.view.lside.render().el).append(this.view.rside.render().el).append(this.view.toolbar.render().el).append(a).append(b).append(this.view.clipboard.render().el),this._setHeight()},_setHeight:function(){var a=this.dimensionModel.get("bodyHeight"),b=this.dimensionModel.get("headerHeight"),c=this.view.toolbar.$el.height(),d=c+b+a;this.$el.css("height",d+"px"),this.dimensionModel.set({toolbarHeight:c})},getValue:function(a,b,c){var d;return d=c?this.dataModel.getOriginal(a,b):this.dataModel.get(a).get(b)},getColumnValues:function(a,b){var c=this.dataModel.pluck(a);return b?$.toJSON(c):c},getRow:function(a,b){var c=this.dataModel.get(a);return c=c&&c.toJSON(),b?$.toJSON(c):c},getRowAt:function(a,b){var c=this.dataModel.at(a).toJSON();return c=b?$.toJSON(c):c},getRowCount:function(){return this.dataModel.length},getElement:function(a,b){var c=this.columnModel.isLside(b)?this.view.lside.$el:this.view.rside.$el;return a=this.dataModel.getMainRowKey(a,b),c.find('tr[key="'+a+'"]').find('td[columnname="'+b+'"]')},select:function(a){this.focusModel.select(a)},unselect:function(){this.focusModel.unselect()},getSelectedRowKey:function(){return this.focusModel.which().rowKey},setValue:function(a,b,c,d){c="string"==typeof c?$.trim(c):c;var e=this.dataModel.get(a),f={};return e?(f[b]=c,e.set(f,{silent:d}),!0):!1},setColumnValues:function(a,b,c,d){c=void 0===c?!0:c;var e={},f={isDisabled:!1,isEditable:!0};e[a]=b,this.dataModel.forEach(function(b){c&&(f=this.getCellState(b.get("rowKey"),a)),!f.isDisabled&&f.isEditable&&b.set(e,{silent:d})},this)},setRowList:function(a,b){this.showGridLayer("loading"),b=void 0===b?!0:b,clearTimeout(this.timeoutIdForSetRowList),this.timeoutIdForSetRowList=setTimeout($.proxy(function(){this.dataModel.set(a,{parse:b}),b||this.dataModel.setOriginalRowList(a)},this),0)},focus:function(a,b,c){this.focusModel.focus(a,b,c)},focusIn:function(a,b,c){var d;this.focus(a,b,c),a=this.dataModel.getMainRowKey(a,b),this.isEditable(a,b)?(d=this.cellFactory.getInstance(this.columnModel.getEditType(b)),d.focusIn(this.getElement(a,b))):this.focusClipboard()},focusAt:function(a,b,c){var d=this.dataModel.at(a),e=this.columnModel.at(b);d&&e&&this.focus(d.get("rowKey"),e.columnName,c)},focusInAt:function(a,b,c){var d=this.dataModel.at(a),e=this.columnModel.at(b);d&&e&&this.focusIn(d.get("rowKey"),e.columnName,c)},blur:function(){this.focusModel.blur()},checkAll:function(){this.setColumnValues("_button",!0)},check:function(a){this.setValue(a,"_button",!0)},uncheckAll:function(){this.setColumnValues("_button",!1)},uncheck:function(a){this.setValue(a,"_button",!1)},clear:function(){this.setRowList([])},removeRow:function(a,b){this.dataModel.removeRow(a,b)},enableRow:function(a){this.dataModel.setRowState(a,"")},disableRow:function(a){this.dataModel.setRowState(a,"DISABLED")},enableCheck:function(a){this.dataModel.setRowState(a,"")},disableCheck:function(a){this.dataModel.setRowState(a,"DISABLED_CHECK")},getCheckedRowKeyList:function(a){var b=[];return _.each(this.dataModel.where({_button:!0}),function(a){b.push(a.get("rowKey"))},this),a?$.toJSON(b):b},getCheckedRowList:function(a){var b=this.dataModel.getRowList(!0);return a?$.toJSON(b):b},getColumnModelList:function(){return this.columnModel.get("columnModelList")},getModifiedRowList:function(a){return this.dataModel.getModifiedRowList(a)},appendRow:function(a){this.dataModel.append(a)},prependRow:function(a){this.dataModel.prepend(a)},setColumnFixIndex:function(a){this.option({columnFixIndex:a}),this.columnModel.set({columnFixIndex:a})},isChanged:function(){var a,b=this.getModifiedRowList();for(a in b)if(b[a].length)return!0;return!1},restore:function(){var a=this.dataModel.getOriginalRowList();this.setRowList(a,!1)},hideGridLayer:function(){_.each(this.view.layer,function(a){a.hide()},this)},showGridLayer:function(a){this.hideGridLayer(),this.view.layer[a]?this.view.layer[a].show():null},getPaginationInstance:function(){var a=this.view.toolbar.pagination;return a?a.instance:void 0},use:function(a,b){return b=$.extend({grid:this},b),AddOn[a]&&(this.addOn[a]=new AddOn[a](b)),this},isSorted:function(){return this.dataModel.isSortedByField()},isEditable:function(a,b){var c,d,e=this.focusModel.which(),f=this.dataModel;return a=void 0!==a?a:e.rowKey,b=void 0!==b?b:e.columnName,c=f.get(a),d=c?c.isEditable(b):!0},isDisabled:function(a,b){var c,d,e=this.focusModel.which(),f=this.dataModel;return a=void 0!==a?a:e.rowKey,b=void 0!==b?b:e.columnName,c=f.get(a),d=c?c.isDisabled(b):!1},getCellState:function(a,b){var c=this.focusModel.which(),d=this.dataModel;return a=void 0!==a?a:c.rowKey,b=void 0!==b?b:c.columnName,d.get(a).getCellState(b)},setColumnModelList:function(a){this.columnModel.set("columnModelList",a)},sort:function(a){this.dataModel.sortByField(a)},getRowList:function(){return this.dataModel.getRowList()},del:function(a,b,c){a=this.dataModel.getMainRowKey(a,b);var d=this.columnModel.getEditType(b),e=this.dataModel.get(a).getRowState().isDisabledCheck,f=["text","text-convertible"],g=-1!==$.inArray(d,f),h=this.option("selectType"),i=this.getCellState(a,b),j=!(!g||!i.isEditable||i.isDisabled);j&&(this.setValue(a,b,"",c),c&&"checkbox"===h&&!e&&this.setValue(a,"_button",!0,c))},getDisabledRowKeyList:function(){},filterData:function(){},enable:function(){},disable:function(){},getRowSpan:function(){},refreshLayout:function(){},addClassNameToColumn:function(){},addClassNameToRow:function(){},removeClassNameFromColumn:function(){},removeClassNameFromRow:function(){},replaceRowList:function(){},setGridSize:function(a){var b=this.dimensionModel,c=(a&&a.width||b.get("width"),b.get("bodyHeight")),d=b.get("headerHeight"),e=b.get("toolbarHeight");a&&a.height&&(c=height-(d+e))},setHeaderColumnTitle:function(){},setScrollBarPosition:function(){},destroy:function(){this.stopListening(),this.destroyChildren(),_.each(this,function(a,b){a instanceof View.Base&&a&&a.destroy&&a.destroy(),"view"===b&&_.each(a,function(a){a&&a.destroy&&a.destroy()},this),a&&a.stopListening&&a.stopListening(),"$el"!==b&&"__$el"!==b&&(this[b]=null,delete this[b])},this),this.$el.replaceWith(this.__$el),this.$el=this.__$el=null}});Grid.prototype.__instance=Grid.prototype.__instance||{};var ne=window.ne=ne||{};ne.Grid=View.Base.extend({initialize:function(a){this.core=new Grid(a),this.listenTo(this.core,"all",this._relayEvent,this)},_relayEvent:function(){this.trigger.apply(this,arguments)},disableRow:function(a){this.core.disableRow(a)},enableRow:function(a){this.core.enableRow(a)},getValue:function(a,b,c){return this.core.getValue(a,b,c)},getColumnValues:function(a,b){return this.core.getColumnValues(a,b)},getRow:function(a,b){return this.core.getRow(a,b)},getRowAt:function(a,b){return this.core.getRowAt(a,b)},getRowCount:function(){return this.core.getRowCount()},getSelectedRowKey:function(){return this.core.focusModel.which().rowKey},getElement:function(a,b){return this.core.getElement(a,b)},setValue:function(a,b,c){this.core.setValue(a,b,c)},setColumnValues:function(a,b,c){this.core.setColumnValues(a,b,c)},setRowList:function(a){this.core.setRowList(a)},focus:function(a,b,c){this.core.focus(a,b,c)},focusAt:function(a,b,c){this.core.focusAt(a,b,c)},focusIn:function(a,b,c){this.core.focusIn(a,b,c)},focusInAt:function(a,b,c){this.core.focusInAt(a,b,c)},blur:function(){this.core.blur()},checkAll:function(){this.core.checkAll()},check:function(a){this.core.check(a)},uncheckAll:function(){this.core.uncheckAll()},uncheck:function(a){this.core.uncheck(a)},clear:function(){this.core.clear()},removeRow:function(a,b){this.core.removeRow(a,b)},enableCheck:function(a){this.core.enableCheck(a)},disableCheck:function(a){this.core.disableCheck(a)},getCheckedRowKeyList:function(a){var b=this.core.getCheckedRowKeyList();return a?$.toJSON(b):b},getCheckedRowList:function(a){var b=this.core.getCheckedRowList();return a?$.toJSON(b):b},getColumnModelList:function(){return this.core.getColumnModelList()},getModifiedRowList:function(a){return this.core.getModifiedRowList(a)},appendRow:function(a){this.core.appendRow(a)},prependRow:function(a){this.core.prependRow(a)},isChanged:function(){return this.core.isChanged()},getAddOn:function(a){return a?this.core.addOn[a]:this.core.addOn},restore:function(){this.core.restore()},select:function(a){this.core.select(a)},unselect:function(){this.core.unselect()},setColumnFixIndex:function(a){this.core.setColumnFixIndex(a)},setColumnModelList:function(a){this.core.setColumnModelList(a)},use:function(a,b){return this.core.use(a,b),this},getRowList:function(){return this.core.getRowList()},sort:function(a){this.core.sort(a)},unSort:function(){this.core.sort("rowKey")},filterData:function(){},enable:function(){},disable:function(){},getRowSpan:function(){},getDisabledRowKeyList:function(){},setGridSize:function(a){var b=this.core.dimensionModel,c=(a&&a.width||b.get("width"),b.get("bodyHeight")),d=b.get("headerHeight"),e=b.get("toolbarHeight");a&&a.height&&(c=height-(d+e))},setHeaderColumnTitle:function(){},setScrollBarPosition:function(){},refreshLayout:function(){},addClassNameToColumn:function(){},addClassNameToRow:function(){},removeClassNameFromColumn:function(){},removeClassNameFromRow:function(){},replaceRowList:function(){},destroy:function(){this.core.destroy(),this.core=null}}),ne.Grid.getInstanceById=function(a){return Grid.prototype.__instance[a]}}();